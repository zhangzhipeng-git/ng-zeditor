{"version":3,"sources":["../../../../projects/bigbigbird/ng-zeditor/src/lib/util/safeHtml.pipe.ts","../../../../projects/bigbigbird/ng-zeditor/src/lib/_alert/tip/tip.ts","../../../../projects/bigbigbird/ng-zeditor/src/lib/service/tokens.ts","../../../../projects/bigbigbird/ng-zeditor/src/lib/_alert/window/window.ts","../../../../projects/bigbigbird/ng-zeditor/src/lib/service/DomService.ts","../../../../projects/bigbigbird/ng-zeditor/src/lib/ui-link/ui-link.ts","../../../../projects/bigbigbird/ng-zeditor/src/lib/ui-table/ui-table.ts","../../../../projects/bigbigbird/ng-zeditor/src/lib/ui-annex/ui-annex.ts","../../../../projects/bigbigbird/ng-zeditor/src/lib/_form/checkbox/checkbox.ts","../../../../projects/bigbigbird/ng-zeditor/src/lib/_form/radio-group/radio-group.ts","../../../../projects/bigbigbird/ng-zeditor/src/lib/util/CommonUtil.ts","../../../../projects/bigbigbird/ng-zeditor/src/lib/util/CursorUtil.ts","../../../../projects/bigbigbird/ng-zeditor/src/lib/ng-zeditor.component.ts","../../../../projects/bigbigbird/ng-zeditor/src/lib/ng-zeditor.module.ts"],"names":["SafeHtmlPipe","sanitizer","this","prototype","transform","content","bypassSecurityTrustHtml","Pipe","args","name","DomSanitizer","TipComponent","appRef","Object","defineProperty","componentRef","embeddedViewRef","rootNodes","Number","POSITIVE_INFINITY","open","options","_this","assign","enter","leave","duration","text","animation","attachView","window","document","body","appendChild","rootNode","ready","t","setTimeout","clearTimeout","active","Infinity","close","t1","t2","removeChild","detachView","Component","selector","template","ApplicationRef","ViewChild","read","TemplateRef","static","TYPE","InjectionToken","WindowComponent","injector","applicationRef","componentFactoryResolver","min","move","e","point","pageX","clientX","top","pageY","clientY","nativeElement","_dis","y","left","x","maxX","parentNode","clientWidth","offsetWidth","maxY","clientHeight","offsetHeight","style","get","switchSize","cssText","maximize","callback","_minStyle","minimize","replace","transition","mask","display","destroy","beforeOpen","title","isScale","isMove","theme","type","component","clear","factory","resolveComponentFactory","componentInstance","createComponent","instance","parent","handler","w","h","leftStyle","tragstart","stopPropagation","preventDefault","returnValue","start","dis","offsetLeft","offsetTop","onmouseup","end","onmousemove","Injector","ComponentFactoryResolver","ElementRef","ViewContainerRef","DomService","componentResolverFactory","tost","toastInstance","create","alert","ReflectiveInjector","resolveAndCreate","provide","useValue","Injectable","UILinkComponent","domService","checked","url","emitLinkHTML","test","html","recieveLinkHTML","UITableComponent","row","col","emitTableHTML","reg","r","c","i","tr","j","recieveTableHTML","UIAnnexComponent","width","height","typeName","rebuild","radioGroup","value","_type","fileChange","files","file","length","option","options$","tag","image","audio","video","pannel","getElementsByTagName","count","base64size","base64","size","fr","FileReader","readAsDataURL","onload","event","recieveLocalFileHTML","getFileHTML","target","result","tip_1","emitUploadFile","isSuccess","timer","src","getImageHTML","getAudioHTML","getVideoHTML","v","selectFile","num","arr","IMAGEARR","AUDIOARR","VIDEOARR","accept","join","onchange","onpropertychange","click","insertOutLink","hasperc","recieveFileLinkHTML","len","CheckBoxComponent","id","disabled","ngOnInit","checkBoxGroup","model","forEach","ck","push","writeValue","obj","registerOnChange","fn","onChange","registerOnTouched","onTouched","myOnChange","Array","index","indexOf","splice","providers","NG_VALUE_ACCESSOR","useExisting","forwardRef","multi","Input","RadioGroupComponent","idPrefix","Math","random","toString","slice","CommonUtil","getElementById","isIE","ActiveXObject","preSibling","node","pre","previousSibling","nodeType","getAllChilds","p","children","call","child","contains","childs","el","rgbToHex","str","charAt","split","str$","dimStr","flat","box","CursorUtil","getSelection","elem","activeElement","focus","createRange","setFirstRange","range","selection","addRange","removeAllRanges","getRange","getRangeAt","rangeCount","selectSelectionElementChilds","selectAllChildren","moveToElementText","select","setSelectionToElement","isStart","collapseToStart","collapseToEnd","collapse","getSelectionText","getRangeText","getRangeCommonParent","commonAncestorContainer","parentElement","deleteRangeContent","deleteContents","pasteHTML","insertNode","outerHTML","AppZeditorComponent","render2","vhtml","onInput","EventEmitter","hasBtn","recieveContent","maxsize","timeout","uploadFile","fontFamilys","key","formatBlocks","colors","fontSizes","value$","codes","fontFamily","fontSize","formatBlock","foreColor","backColor","code","switchFontFamilyPannel","switchFontSizePannel","switchFormatBlockPannel","switchForeColorPannel","switchBackColorPannel","switchCodePannel","isBold","isItalic","isUnderline","isStrikeThrough","scriptActive","justifyActive","isInEditStatus","full","inCode","headerRef","editorRef","pannelRef","footerRef","fontNameRef","fontSizeRef","formatBlockRef","foreColorRef","backColorRef","codeRef","undefined","setDisabledState","isDisabled","initFormatData","editor","FORMAT","pannelFocus","setFontName","ensureFocus","getAttribute","cmd","setFontSize","setFormatBlock","setForeColor","setBackColor","insertCode","toLowerCase","setRange","insertBrOnReturn","isSupport","switchBold","switchItalic","switchUnderline","switchStrikeThrough","setScript","setJustifyactive","indent","outdent","insertOrderedList","insertUnorderedList","insertTable","startEdit","insertLink","insertFile","parser","emit","insertHorizontalRule","paste","cut","copy","selectAll","redo","undo","deleteSelect","history","localStorage","getItem","autoActive","setRangeAndEmitValue","removeFormat","setDefaultFormat","hideSwitchPannel","srcElement","fontNameEl","fontSizeEl","foreColorEl","backColorEl","formatBlockEl","codeEl","SwitchScreen","header","footer","innerHeight","keydown","keyCode","which","charCode","tab","keyup","isRangeInCode","pannelOnClick","initEdit","pannelOnPaste","clipboardData","getData","df","createDocumentFragment","createTextNode","arg0","debounce","innerHTML","innerText","textContent","setItem","emitContent","editPannel","charCodeAt","toast","substr","getUrlsByTag","innerTEXT","urls","recoverRange","recover","queryCommandSupported","insertHTML","createElement","k","ui","execCommand","nodeName","grandChildTograndParent","formatBlock$","find","fb","toUpperCase","fontFamily$","ff","fontSize$","fs","foreColor$","cr","backgroundColor","backColor$","textAlign","o","tags","item","nodes","parent$","tagName","querySelectorAll","f","encapsulation","ViewEncapsulation","None","Renderer2","Output","NgModule","imports","CommonModule","FormsModule","declarations","entryComponents","exports"],"mappings":"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","sourcesContent":["/*\r\n * Created Date: Friday, August 21st 2020, 10:32:15 pm\r\n * Author: æ¨æµã®ççº¸\r\n * ---------------------------------------------------\r\n * Description: ä¿¡ä»»htmlç®¡é\r\n * ---------------------------------------------------\r\n * Last Modified: Saturday August 22nd 2020 11:36:53 am\r\n * Modified By: æ¨æµã®ççº¸\r\n * Contact: 1029512956@qq.com\r\n * Copyright (c) 2020 ZXWORK\r\n */\r\n\r\nimport { Pipe, PipeTransform } from '@angular/core';\r\nimport { DomSanitizer } from '@angular/platform-browser';\r\n\r\n@Pipe({ name: 'safeHTML'})\r\nexport class SafeHtmlPipe implements PipeTransform {\r\n  constructor(private sanitizer: DomSanitizer) {}\r\n  transform(content) {\r\n    return this.sanitizer.bypassSecurityTrustHtml(content);\r\n  }\r\n}\r\n","/*\r\n * Created Date: Friday, August 21st 2020, 10:32:15 pm\r\n * Author: æ¨æµã®ççº¸\r\n * ---------------------------------------------------\r\n * Description: toastç»ä»¶\r\n * ---------------------------------------------------\r\n * Last Modified: Saturday August 22nd 2020 11:25:54 am\r\n * Modified By: æ¨æµã®ççº¸\r\n * Contact: 1029512956@qq.com\r\n * Copyright (c) 2020 ZXWORK\r\n */\r\n\r\nimport { Component, ViewChild, TemplateRef, ApplicationRef, ComponentRef, EmbeddedViewRef } from '@angular/core';\r\n\r\n@Component({\r\n    // tslint:disable-next-line: component-selector\r\n    selector: 'app-tip',\r\n    templateUrl: 'tip.component.html'\r\n})\r\n\r\nexport class TipComponent {\r\n    /** æ¯å¦æ¿æ´» */\r\n    active: boolean;\r\n    /** æ¯å¦åå¤è¦æ¿æ´» */\r\n    ready: boolean;\r\n    text: string;\r\n    enter: number;\r\n    leave: number;\r\n    duration: number;\r\n    animation: string;\r\n    componentRef: ComponentRef<TipComponent>;\r\n    @ViewChild('tip', {read: TemplateRef, static: true }) tip: TemplateRef<any>;\r\n    get embeddedViewRef() {\r\n        return this.componentRef.hostView as EmbeddedViewRef<any>;\r\n    }\r\n    get rootNode() {\r\n        return this.embeddedViewRef.rootNodes[0];\r\n    }\r\n    get Infinity() {\r\n        return Number.POSITIVE_INFINITY;\r\n    }\r\n    constructor(\r\n        private appRef: ApplicationRef\r\n    ) { }\r\n\r\n    /**\r\n     * æå¼\r\n     * @param options éç½®åæ°\r\n     */\r\n    open(options?: Options) {\r\n        options = Object.assign(this, { enter: 200, leave: 200, duration: 1500, text: '', animation: 'scale' }, options);\r\n        this.text = options.text;\r\n        this.enter = options.enter;\r\n        this.leave = options.leave;\r\n        this.duration = options.duration;\r\n        this.animation = options.animation;\r\n        this.appRef.attachView(this.embeddedViewRef);\r\n        window.document.body.appendChild(this.rootNode);\r\n        // å»¶æ¶æ¿æ´»ï¼é²æ­¢è¿å¥å¨ç»ä¸çæ\r\n        this.ready = true;\r\n        const t = setTimeout(() => { clearTimeout(t); this.active = true; });\r\n        // éæå¨å³é­ï¼å¨æå®æ¶é´åå³é­\r\n        if (this.duration !== -1 && this.duration !== Infinity) { this.close(); }\r\n    }\r\n\r\n    /**\r\n     * å³é­å¼¹çª\r\n     */\r\n    close() {\r\n        // ç¦»å¼\r\n        const t1 = setTimeout(() => {\r\n            clearTimeout(t1);\r\n            this.ready = false;\r\n            this.active = false;\r\n        }, this.enter + this.duration);\r\n        // å½»åºç§»é¤\r\n        const t2 = setTimeout(() => {\r\n            clearTimeout(t2);\r\n            window.document.body.removeChild(this.rootNode);\r\n            this.appRef.detachView(this.embeddedViewRef);\r\n        }, this.enter + this.duration + this.leave);\r\n    }\r\n\r\n}\r\n\r\nexport interface Options {\r\n    /* æç¤ºæå­ */\r\n    text?: string;\r\n    /**\r\n     * å¨ç»åç§°\r\n     * - trans1 ä»ä¸å¾ä¸ï¼è¿å¥ï¼ -> ä»ä¸å°ä¸ï¼ç¦»å¼ï¼\r\n     * - trans2 ä»ä¸å°ä¸ï¼è¿å¥ï¼ -> ä»ä¸å¾ä¸ï¼ç¦»å¼ï¼\r\n     * - scale  æ¾å¤§ï¼è¿å¥ï¼ -> ä»ä¸å°ä¸ï¼ç¦»å¼ï¼ç¼©å°\r\n     */\r\n    animation?: string;\r\n    /** åçæ¶é´ */\r\n    duration?: number;\r\n    /** è¿å¥è¿æ¸¡æ¶é´ */\r\n    enter?: number;\r\n    /** ç¦»å¼è¿æ¸¡æ¶é´ */\r\n    leave?: number;\r\n}\r\n","/*\r\n * Created Date: Friday, August 21st 2020, 10:32:15 pm\r\n * Author: æ¨æµã®ççº¸\r\n * ---------------------------------------------------\r\n * Description: ä»¤çåº\r\n * ---------------------------------------------------\r\n * Last Modified: Saturday August 22nd 2020 11:34:40 am\r\n * Modified By: æ¨æµã®ççº¸\r\n * Contact: 1029512956@qq.com\r\n * Copyright (c) 2020 ZXWORK\r\n */\r\n\r\nimport { InjectionToken } from '@angular/core';\r\nexport const TYPE = new InjectionToken('string or function');\r\n","/*\r\n * Created Date: Friday, August 21st 2020, 10:32:15 pm\r\n * Author: æ¨æµã®ççº¸\r\n * ---------------------------------------------------\r\n * Description: å¼¹çªç»ä»¶\r\n * ---------------------------------------------------\r\n * Last Modified: Saturday August 22nd 2020 11:26:52 am\r\n * Modified By: æ¨æµã®ççº¸\r\n * Contact: 1029512956@qq.com\r\n * Copyright (c) 2020 ZXWORK\r\n */\r\n\r\nimport {\r\n    Component,\r\n    ViewChild,\r\n    ElementRef,\r\n    Type,\r\n    ViewContainerRef,\r\n    ApplicationRef,\r\n    ComponentFactoryResolver,\r\n    ComponentRef,\r\n    EmbeddedViewRef,\r\n    Injector\r\n} from '@angular/core';\r\nimport { TYPE } from '../../service/tokens';\r\n\r\n@Component({\r\n    selector: 'app-window',\r\n    templateUrl: './window.component.html',\r\n})\r\nexport class WindowComponent {\r\n    min: boolean = true;\r\n    theme: string;\r\n    animation: string;\r\n    title: string;\r\n    isScale: boolean;\r\n    active: boolean;\r\n    isMove: boolean;\r\n    callback: any;\r\n    leave: number;\r\n    enter: number;\r\n    content: string | Type<any>;\r\n    handler: any;\r\n    componentRef: ComponentRef<WindowComponent>;\r\n    @ViewChild('mask', { read: ElementRef, static: true }) mask: ElementRef;\r\n    @ViewChild('window', { read: ElementRef, static: true }) window: ElementRef;\r\n    @ViewChild('component', { read: ViewContainerRef, static: true }) component: ViewContainerRef;\r\n    get embeddedViewRef() {\r\n        return this.componentRef.hostView as EmbeddedViewRef<any>;\r\n    }\r\n    get rootNode() {\r\n        return this.embeddedViewRef.rootNodes[0];\r\n    }\r\n    get type() {\r\n        return this.injector.get(TYPE) as string;\r\n    }\r\n\r\n    constructor(\r\n        private injector: Injector,\r\n        private applicationRef: ApplicationRef,\r\n        private componentFactoryResolver: ComponentFactoryResolver\r\n    ) { }\r\n    /**\r\n     * æ¾å¤§ç¼©å°\r\n     * @param e ç¹å»äºä»¶\r\n     */\r\n    switchSize(e: any) {\r\n        if (this.min) { // å½åç¶æä¸ºç¼©å°ï¼ç¹å»æ¾å¤§\r\n            this.window.nativeElement.style.cssText = 'height:100%;width:100%;top:0;left:0;';\r\n            this.min = false;\r\n            const maximize = this.callback.maximize;\r\n            // tslint:disable-next-line: no-unused-expression\r\n            maximize && maximize();\r\n        } else { // å½åç¶æä¸ºæ¾å¤§ï¼ç¹å»ç¼©å°\r\n            this.window.nativeElement.style.cssText = this.window.nativeElement._minStyle;\r\n            this.min = true;\r\n            const minimize = this.callback.minimize;\r\n            // tslint:disable-next-line: no-unused-expression\r\n            minimize && minimize();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * ç¹å»å³é­å¼¹çª\r\n     * @param e äºä»¶\r\n     */\r\n    close(e: any) {\r\n        // è®¾ç½®å³é­æ¶çæ¸å\r\n        // å°è¡åtopæ ·å¼æ¶é¤ï¼ä¼åçº§æé«ä¼è¦çcssæä»¶ä¸­çtopæ ·å¼ï¼ï¼ä½¿cssä¸­ç¦»å¼æ¶çtopæ ·å¼çæï¼å¦åcssç±»trans1åtrans2çç¦»å¼æ¸åä¸çæ\r\n        this.window.nativeElement.style.cssText = this.window.nativeElement.style.cssText.replace(/top:(.*)?;/, '');\r\n        this.window.nativeElement.style.transition = 'all ' + this.leave / 1000 + 's';\r\n        this.active = false;\r\n        this.mask.nativeElement.style.display = 'none';\r\n        // ç§»é¤\r\n        setTimeout(() => {\r\n            window.document.body.removeChild(this.rootNode);\r\n            this.applicationRef.detachView(this.embeddedViewRef);\r\n            this.componentRef.destroy();\r\n            this.componentRef = null;\r\n            const close = this.callback.close;\r\n            // tslint:disable-next-line: no-unused-expression\r\n            close && close(e);\r\n\r\n        }, this.leave);\r\n    }\r\n\r\n    /**\r\n     * åå§åæå¼æä½\r\n     * @param  options?\r\n     */\r\n    beforeOpen(options?: WindowOptions) {\r\n        // tslint:disable-next-line: max-line-length\r\n        Object.assign(this, { title: 'å¼¹çª', animation: 'trans1', enter: 200, leave: 200, isScale: false, isMove: true, content: 'ä»ä¹ä¹æ¨æ~', callback: {}, theme: '' }, options);\r\n        if (this.type === 'string') { return; }\r\n        this.component.clear();\r\n        const factory = this.componentFactoryResolver.resolveComponentFactory( (this.content) as Type<any>);\r\n        const componentRef = this.component.createComponent(factory);\r\n        const componentInstance = componentRef.instance;\r\n        componentInstance.parent = this;\r\n        componentInstance.handler = this.handler;\r\n    }\r\n\r\n    /**\r\n     * æå¼å¼¹çª\r\n     */\r\n    open(options?: WindowOptions) {\r\n        this.beforeOpen(options);\r\n        this.mask.nativeElement.style.display = 'block';\r\n        this.applicationRef.attachView(this.embeddedViewRef);\r\n        window.document.body.appendChild(this.rootNode);\r\n        // å·¦å³å±ä¸­ï¼topç¨cssæ§å¶\r\n        const w = this.window.nativeElement.offsetWidth;\r\n        const h = this.window.nativeElement.offsetHeight;\r\n        // å½åçªå£å¤§å°ï¼this.window.parentNode => position:fixed;height:100%;width:100%\r\n        const ww = this.window.nativeElement.parentNode.offsetWidth;\r\n        // åå§å®ä½\r\n        const leftStyle = 'left:' + ((ww - w) / 2) + 'px;';\r\n        this.window.nativeElement.style.cssText += leftStyle;\r\n        // è®°å½æå°åæ¶çæ ·å¼\r\n        this.window.nativeElement._minStyle = leftStyle + 'width:' + (w + 1) + 'px;height:' + (h + 1) + 'px;';\r\n        // è®¾ç½®æå¼æ¶çæ¸å\r\n        this.window.nativeElement.style.transition = 'all ' + (this.enter / 1000) + 's';\r\n        // è¿å¥æ¿æ´»ç¶æï¼å¼¹çªåçï¼\r\n        setTimeout(() => this.active = true);\r\n        // åæ¶æ¸åï¼å¦åç§»å¨ä¼ææ¸å\r\n        setTimeout(() => {\r\n            this.window.nativeElement.style.transition = 'none';\r\n        }, this.enter);\r\n    }\r\n    /**\r\n     * é»æ­¢ææ½\r\n     * @param e ææ½äºä»¶\r\n     */\r\n    tragstart(e: any) {\r\n        e.stopPropagation();\r\n        e.preventDefault();\r\n        e.returnValue = false;\r\n    }\r\n    /**\r\n     * å¼å§ç§»å¨\r\n     * @param e äºä»¶\r\n     */\r\n    start(e: any) {\r\n        // å¨å±ç¶æä¸å¯ç§»å¨\r\n        if (!this.min) { return; }\r\n        // ç§»å¨åæ°ä¼ å¥falseï¼ä¸å¯ç§»å¨\r\n        if (!this.isMove) { return; }\r\n        const point = {\r\n            x: e.pageX || e.clientX,\r\n            y: e.pageY || e.clientY\r\n        };\r\n        const dis = {\r\n            x: this.window.nativeElement.offsetLeft - point.x,\r\n            y: this.window.nativeElement.offsetTop - point.y\r\n        };\r\n        this.window.nativeElement._dis = dis;\r\n        // æµè§å¨çªä½\r\n        window.onmouseup = this.end;\r\n        window.onmousemove = this.move;\r\n    }\r\n    /**\r\n     * ç§»å¨\r\n     * @param e äºä»¶\r\n     */\r\n    move = (e: any) => {\r\n        const point = {\r\n            x: e.pageX || e.clientX,\r\n            y: e.pageY || e.clientY\r\n        };\r\n        let top = point.y + this.window.nativeElement._dis.y;\r\n        let left = point.x + this.window.nativeElement._dis.x;\r\n        // å½åçªå£å¤§å°ï¼this.window.parentNode => position:fixed;height:100%;width:100%\r\n        let maxX = this.window.nativeElement.parentNode.clientWidth - this.window.nativeElement.offsetWidth;\r\n        let maxY = this.window.nativeElement.parentNode.clientHeight - this.window.nativeElement.offsetHeight;\r\n        if (maxX < 0) { maxX = 0; }\r\n        if (maxY < 0) { maxY = 0; }\r\n        // å¤æ­æ¯å¦è¶ç\r\n        if (top <= 0) { // yæ¹å\r\n            top = 0;\r\n        } else if (top >= maxY) {\r\n            top = maxY;\r\n        }\r\n        if (left <= 0) { // xæ¹å\r\n            left = 0;\r\n        } else if (left >= maxX) {\r\n            left = maxX - 1; // æ¶é¤è¯¯å·®ï¼é²æ­¢å³æè¿åº¦å¯¼è´å®½åº¦åå°\r\n        }\r\n        this.window.nativeElement.style.top = top + 'px';\r\n        this.window.nativeElement.style.left = left + 'px';\r\n    }\r\n    /**\r\n     * åæ­¢ç§»å¨\r\n     * @param e äºä»¶\r\n     */\r\n    end(e: any) {\r\n        window.onmouseup = null;\r\n        window.onmousemove = null;\r\n    }\r\n}\r\n\r\nexport interface WindowOptions {\r\n    /** å¼¹çªæ é¢ */\r\n    title?: string;\r\n    /**\r\n     * å¨ç»åç§°\r\n     * - trans1 ä»ä¸å¾ä¸ï¼è¿å¥ï¼ -> ä»ä¸å°ä¸ï¼ç¦»å¼ï¼\r\n     * - trans2 ä»ä¸å°ä¸ï¼è¿å¥ï¼ -> ä»ä¸å¾ä¸ï¼ç¦»å¼ï¼\r\n     * - scale  æ¾å¤§ï¼è¿å¥ï¼ -> ä»ä¸å°ä¸ï¼ç¦»å¼ï¼ç¼©å°\r\n     */\r\n    animation?: string;\r\n    /** è¿å¥è¿æ¸¡æ¶é´ */\r\n    enter?: number;\r\n    /** ç¦»å¼è¿æ¸¡æ¶é´ */\r\n    leave?: number;\r\n    /** åè° */\r\n    callback?: WindowCallback;\r\n    /** html | ç»ä»¶ */\r\n    content?: string | Type<any>;\r\n    /** çªä½æ¯å¦å¯æ¾å¤§ç¼©å° */\r\n    isScale?: boolean;\r\n    /** æ¯å¦å¯ç§»å¨ */\r\n    isMove?: boolean;\r\n    /**\r\n     *  ç»ä»¶å®ä¾\r\n     */\r\n    handler?: any;\r\n    // tslint:disable-next-line: jsdoc-format\r\n    /** ä¸»é¢ r g b p*/\r\n    theme?: string;\r\n}\r\n\r\n/** åè° */\r\nexport interface WindowCallback {\r\n    /** å³é­åè° */\r\n    close?(): void;\r\n    /** æå°ååè° */\r\n    minimize?(): void;\r\n    /** æå¤§ååè° */\r\n    maximize?(): void;\r\n}\r\n","/*\r\n * Created Date: Friday, August 21st 2020, 10:32:15 pm\r\n * Author: æ¨æµã®ççº¸\r\n * ---------------------------------------------------\r\n * Description: domæä¾å\r\n * ---------------------------------------------------\r\n * Last Modified: Saturday August 22nd 2020 11:34:12 am\r\n * Modified By: æ¨æµã®ççº¸\r\n * Contact: 1029512956@qq.com\r\n * Copyright (c) 2020 ZXWORK\r\n */\r\n\r\nimport { Injectable, ComponentFactoryResolver, Injector, ReflectiveInjector } from '@angular/core';\r\nimport { TipComponent, Options } from '../_alert/tip/tip';\r\nimport { WindowComponent, WindowOptions } from '../_alert/window/window';\r\nimport { TYPE } from './tokens';\r\n\r\n@Injectable()\r\nexport class DomService {\r\n\r\n    /** tostå®ä¾ */\r\n    private toastInstance: TipComponent;\r\n\r\n    constructor(\r\n        private injector: Injector,\r\n        private componentResolverFactory: ComponentFactoryResolver\r\n    ) { }\r\n\r\n    tost(options?: Options) {\r\n        if (!this.toastInstance) {\r\n            const factory = this.componentResolverFactory.resolveComponentFactory(TipComponent);\r\n            const componentRef = factory.create(this.injector);\r\n            this.toastInstance = componentRef.instance;\r\n            this.toastInstance.componentRef = componentRef;\r\n        }\r\n        this.toastInstance.open(options);\r\n        return this.toastInstance;\r\n    }\r\n\r\n    alert(options?: WindowOptions) {\r\n        const factory = this.componentResolverFactory.resolveComponentFactory(WindowComponent);\r\n        // tslint:disable-next-line: deprecation\r\n        const injector = ReflectiveInjector.resolveAndCreate([{provide: TYPE, useValue: typeof options.content}]);\r\n        const componentRef = factory.create(injector);\r\n        const instance = componentRef.instance;\r\n        instance.componentRef = componentRef;\r\n        instance.open(options);\r\n    }\r\n\r\n}\r\n","/*\r\n * Created Date: Friday, August 21st 2020, 10:32:15 pm\r\n * Author: æ¨æµã®ççº¸\r\n * ---------------------------------------------------\r\n * Description: é¾æ¥ç»ä»¶\r\n * ---------------------------------------------------\r\n * Last Modified: Saturday August 22nd 2020 11:35:23 am\r\n * Modified By: æ¨æµã®ççº¸\r\n * Contact: 1029512956@qq.com\r\n * Copyright (c) 2020 ZXWORK\r\n */\r\n\r\nimport { Component } from '@angular/core';\r\nimport { DomService } from '../service/DomService';\r\n\r\n@Component({\r\n    selector: 'app-link',\r\n    templateUrl: './ui-link.component.html'\r\n})\r\nexport class UILinkComponent {\r\n    /** æ¯å¦å¨æ°çªå£æå¼ */\r\n    checked = false;\r\n    /** æ é¢ */\r\n    title = '';\r\n    /** url */\r\n    url = 'https://';\r\n    /** åå®¹ */\r\n    content = '';\r\n    handler: any;\r\n    parent: any;\r\n\r\n    constructor(\r\n        private domService: DomService\r\n    ) { }\r\n\r\n    /**\r\n     * åå°form\r\n     */\r\n    emitLinkHTML() {\r\n        if (!/^(\\/\\/|https?:)\\/\\/.+/.test(this.url)) {\r\n            this.domService.tost({\r\n                text: 'é¾æ¥å°åä¸è§è'\r\n            });\r\n            return;\r\n        }\r\n        if (!this.content) {\r\n            this.domService.tost({\r\n                text: 'è¯·å¡«ååå®¹'\r\n            });\r\n            return;\r\n        }\r\n        const html =\r\n            '<a href=\"' +\r\n            this.url +\r\n            '\" ' +\r\n            (this.checked ? 'target=\"_blank\"' : '') +\r\n            (this.title ? 'title=' + this.title : '') +\r\n            '>' +\r\n            this.content +\r\n            '</a>';\r\n        if (this.handler.recieveLinkHTML(html)) {\r\n            this.parent.close();\r\n        }\r\n    }\r\n}\r\n\r\n","/*\r\n * Created Date: Friday, August 21st 2020, 10:32:15 pm\r\n * Author: æ¨æµã®ççº¸\r\n * ---------------------------------------------------\r\n * Description: æå¥è¡¨æ ¼ç»ä»¶\r\n * ---------------------------------------------------\r\n * Last Modified: Saturday August 22nd 2020 11:35:55 am\r\n * Modified By: æ¨æµã®ççº¸\r\n * Contact: 1029512956@qq.com\r\n * Copyright (c) 2020 ZXWORK\r\n */\r\n\r\nimport { Component } from '@angular/core';\r\nimport { DomService } from '../service/DomService';\r\n\r\n@Component({\r\n    selector: 'app-table',\r\n    templateUrl: './ui-table.component.html'\r\n})\r\nexport class UITableComponent {\r\n    /** è¡æ° */\r\n    row = '2';\r\n    /** åæ° */\r\n    col = '2';\r\n    handler: any;\r\n    parent: any;\r\n    constructor(\r\n        private domService: DomService\r\n    ) {\r\n    }\r\n\r\n    emitTableHTML() {\r\n        const reg = /[1-9]{1,2}/;\r\n        if (!reg.test(this.row)) {\r\n            this.domService.tost({\r\n                text: 'è¡æ°ä¸åè¦æ±~'\r\n            });\r\n            return;\r\n        }\r\n        if (!reg.test(this.col)) {\r\n            this.domService.tost({\r\n                text: 'åæ°ä¸åè¦æ±~'\r\n            });\r\n            return;\r\n        }\r\n        let html = '<div><table style=\"width:100%\"><tbody>';\r\n        const r = Number(this.row);\r\n        const c = Number(this.col);\r\n        for (let i = 0; i < r; i++) {\r\n            let tr = '<tr>';\r\n            for (let j = 0; j < c; j++) {\r\n                tr += '<td>' /* + input */ + '</td>';\r\n            }\r\n            html += tr + '</tr>';\r\n        }\r\n        html += '</tbody></table></div><p><br/></p>';\r\n        if (this.handler.recieveTableHTML(html)) {\r\n            this.parent.close();\r\n        }\r\n    }\r\n}\r\n","/*\r\n * Created Date: Friday, August 21st 2020, 10:32:15 pm\r\n * Author: æ¨æµã®ççº¸\r\n * ---------------------------------------------------\r\n * Description: æå¥æä»¶ç»ä»¶\r\n * ---------------------------------------------------\r\n * Last Modified: Saturday August 22nd 2020 11:35:02 am\r\n * Modified By: æ¨æµã®ççº¸\r\n * Contact: 1029512956@qq.com\r\n * Copyright (c) 2020 ZXWORK\r\n */\r\nimport { Component, ViewChild, ElementRef } from '@angular/core';\r\nimport { Radio } from '../_form/radio-group/radio-group';\r\nimport { DomService } from '../service/DomService';\r\nimport { TipComponent } from '../_alert/tip/tip';\r\nimport { AppZeditorComponent } from '../ng-zeditor.component';\r\n\r\n@Component({\r\n    selector: 'app-annex',\r\n    templateUrl: './ui-annex.component.html'\r\n})\r\nexport class UIAnnexComponent {\r\n    /** å¾çç±»å */\r\n    static IMAGEARR = ['image/gif', 'image/jpeg', 'image/jpg', 'image/png', 'image/svg'];\r\n    static AUDIOARR = ['audio/mp3', 'audio/ogg', 'audio/wav'];\r\n    static VIDEOARR = ['video/mp4', 'video/ogg', 'video/webm'];\r\n    url = 'https://';\r\n    width = '100%';\r\n    height = 'auto';\r\n    /** è·åç±»åå¯¹åºçåç§° */\r\n    typeName = 'å¾ç';\r\n    /** éæ¸²æinput file */\r\n    rebuild = true;\r\n    radioGroup: Radio[] = [{ value: 'image', text: 'å¾ç' }, { value: 'audio', text: 'é³é¢' }, { value: 'video', text: 'è§é¢' }];\r\n    @ViewChild('file', { static: false, read: ElementRef }) file: ElementRef;\r\n    // tslint:disable-next-line: variable-name\r\n    _type: 'image' | 'audio' | 'video' = 'image';\r\n    handler: any;\r\n    parent: any;\r\n    set type(v: 'image' | 'audio' | 'video') {\r\n        this._type = v;\r\n        this.typeName = { image: 'å¾ç', audio: 'é³é¢', video: 'è§é¢' }[v];\r\n    }\r\n    get type() {\r\n        return this._type;\r\n    }\r\n\r\n    constructor(\r\n        private domService: DomService\r\n    ) { }\r\n\r\n    /**\r\n     * ç¹å»æ¬å°ä¸ä¼ \r\n     */\r\n    selectFile() {\r\n        // éè¦åè®¾ç½®å®½åº¦åé«åº¦\r\n        const num = /^[1-9]\\d{1,3}(px|rem|em|vw|vh|%)?|auto|inherit|unset$/i;\r\n        if (!num.test(this.width + '') || !num.test(this.height + '')) {\r\n            this.domService.tost({\r\n                text: `ä¸ä¼ ${this.typeName}åè¯·å¡«ååéçé«åº¦åå®½åº¦~`\r\n            });\r\n            return;\r\n        }\r\n        const file = this.file.nativeElement;\r\n        const arr = {\r\n            image: UIAnnexComponent.IMAGEARR,\r\n            audio: UIAnnexComponent.AUDIOARR,\r\n            video: UIAnnexComponent.VIDEOARR,\r\n        }[this.type];\r\n        file.accept = arr.join(',');\r\n        if ('onchange' in file) {\r\n            file.onchange = this.fileChange;\r\n        } else {\r\n            file.onpropertychange = this.fileChange;\r\n        }\r\n        file.click();\r\n    }\r\n\r\n    /**\r\n     * éæ©æä»¶\r\n     */\r\n    fileChange = () => {\r\n        const files = this.file.nativeElement.files;\r\n        const file = files[0];\r\n        if (!files.length) { return; }\r\n        this.rebuild = false;\r\n        setTimeout(() => { this.rebuild = true; });\r\n        // ç¼è¾å¨å®ä¾\r\n        const handler: AppZeditorComponent = this.handler;\r\n        // è·åç¼è¾å¨banneréç½®åæ°\r\n        const option = handler.options$[this.type] || {};\r\n        // æ ç­¾\r\n        const tag = { image: 'IMG', audio: 'AUDIO', video: 'VIDEO' }[this.type];\r\n        // å¤æ­æä»¶æ¯å¦è¶è¿æ°é\r\n        if (handler.pannel.getElementsByTagName(tag).length >= (option.count || 1)) {\r\n            this.domService.tost({\r\n                text: `${this.typeName}å·²è¶åºæå¤§æ°é`\r\n            });\r\n            return;\r\n        }\r\n        // å¤æ­æä»¶æ¯å¦éè½¬æbase64\r\n        const base64size = option.base64 || 0;\r\n        if (base64size && file.size <= base64size) {\r\n            // è½¬æbase64\r\n            const fr = new FileReader();\r\n            fr.readAsDataURL(file);\r\n            fr.onload = (event: any) => {\r\n                if (handler.recieveLocalFileHTML(this.getFileHTML(event.target.result))) {\r\n                    this.parent.close();\r\n                }\r\n            };\r\n        } else {\r\n            // äº¤ç»å¤é¨è¿è¡å¤ç\r\n            const tip: TipComponent = this.domService.tost({\r\n                text: 'ä¸ä¼ ä¸­~',\r\n                duration: -1\r\n            });\r\n            // tslint:disable-next-line: no-unused-expression\r\n            handler.emitUploadFile && handler.emitUploadFile(this.type, file, this.getFileHTML, (isSuccess: boolean, t?: number) => {\r\n                if (isSuccess) { // ä¸ä¼ æå\r\n                    tip.close();\r\n                    this.parent.close();\r\n                    return;\r\n                }\r\n                if (!t) { // ä¸ä¼ å¤±è´¥\r\n                    tip.close();\r\n                    this.parent.close();\r\n                    tip.open({ text: 'ä¸ä¼ å¤±è´¥~' });\r\n                    return;\r\n                }\r\n                // ä¸ä¼ è¶æ¶\r\n                const timer = setTimeout(() => {\r\n                    clearTimeout(timer);\r\n                    tip.close();\r\n                    this.parent.close();\r\n                    tip.open({ text: 'ä¸ä¼ è¶æ¶~' });\r\n                }, t);\r\n            });\r\n        }\r\n    }\r\n    /**\r\n     * æå¥å¤é¾\r\n     */\r\n    insertOutLink() {\r\n        const hasperc = /^[1-9]\\d{1,3}(px|rem|em|vw|vh|%)?$/i;\r\n        if (!hasperc.test(this.width)) {\r\n            this.domService.tost({\r\n                text: 'è¯·å¡«ååéçå®½åº¦~'\r\n            });\r\n            return;\r\n        }\r\n        if (!hasperc.test(this.height)) {\r\n            this.domService.tost({\r\n                text: 'è¯·å¡«ååéçé«åº¦~'\r\n            });\r\n            return;\r\n        }\r\n        if (!/^(\\/\\/|https?:)\\/\\/.+/.test(this.url)) {\r\n            this.domService.tost({\r\n                text: 'é¾æ¥å°åä¸è§è'\r\n            });\r\n            return;\r\n        }\r\n        const html = this.getFileHTML(this.url);\r\n        if (this.handler.recieveFileLinkHTML(html)) {\r\n            this.parent.close();\r\n            this.parent = null;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * ä¼ å¥srcå¹¶æ ¹æ®ç±»åè·åæä»¶html\r\n     */\r\n    getFileHTML = (src: string) => {\r\n        let html = '';\r\n        switch (this.type) {\r\n            case 'image':\r\n                html = this.getImageHTML(src);\r\n                break;\r\n            case 'audio':\r\n                html = this.getAudioHTML(src);\r\n                break;\r\n            case 'video':\r\n                html = this.getVideoHTML(src);\r\n                break;\r\n        }\r\n        return html;\r\n    }\r\n\r\n    /**\r\n     * è·åæå¥å¾ççHTML\r\n     * @param src urlæbase64\r\n     */\r\n    getImageHTML(src: string) {\r\n        return (\r\n            '<p>' +\r\n            '<img src=\"' +\r\n            src +\r\n            '\" style=\"height:' +\r\n            this.height +\r\n            ';width:' +\r\n            this.width +\r\n            ';object-fit:cover;\" />' +\r\n            '</p><p><br/></p>'\r\n        );\r\n    }\r\n    /**\r\n     * è·åæå¥é³é¢çHTML\r\n     * @param src url\r\n     */\r\n    getAudioHTML(src: string) {\r\n        const arr = UIAnnexComponent.AUDIOARR;\r\n        // tslint:disable-next-line: max-line-length\r\n        let html = '<p><audio controls style=\"display:inline-block;height:' + this.height + ';width:' + this.width + ';\">';\r\n        for (let i = 0, len = arr.length; i < len; i++) {\r\n            html += '<source src=\"' + src + '\" type=\"' + arr[i] + '\">';\r\n        }\r\n        html += 'æ¨çæµè§å¨ä¸æ¯æAudioæ ç­¾ã';\r\n        html += '</audio>&#8205;&zwj;</p><p><br/></p>';\r\n        return html;\r\n    }\r\n\r\n    /**\r\n     * è·åæå¥è§é¢çHTML\r\n     */\r\n    getVideoHTML(src: string) {\r\n        const arr = UIAnnexComponent.VIDEOARR;\r\n        // tslint:disable-next-line: max-line-length\r\n        let html = '<p><video controls style=\"display:inline-block;height:' + this.height + ';width:' + this.width + ';\">';\r\n        for (let i = 0, len = arr.length; i < len; i++) {\r\n            html += '<source src=\"' + src + '\" type=\"' + arr[i] + '\">';\r\n        }\r\n        html += 'æ¨çæµè§å¨ä¸æ¯æVideoæ ç­¾ã';\r\n        html += '</video>&#8205;&zwj;</p><p><br/></p>';\r\n        return html;\r\n    }\r\n\r\n}\r\n","/*\r\n * Created Date: Friday, August 21st 2020, 10:32:15 pm\r\n * Author: æ¨æµã®ççº¸\r\n * ---------------------------------------------------\r\n * Description: å¤éæ¡ç»ä»¶\r\n * ---------------------------------------------------\r\n * Last Modified: Saturday August 22nd 2020 11:29:21 am\r\n * Modified By: æ¨æµã®ççº¸\r\n * Contact: 1029512956@qq.com\r\n * Copyright (c) 2020 ZXWORK\r\n */\r\n\r\nimport { Component, Input, forwardRef, OnInit } from '@angular/core';\r\nimport { ControlValueAccessor, NG_VALUE_ACCESSOR } from '@angular/forms';\r\n\r\n@Component({\r\n    selector: 'app-checkbox',\r\n    templateUrl: './checkbox.component.html',\r\n    providers: [{\r\n        provide: NG_VALUE_ACCESSOR,\r\n        useExisting: forwardRef(() => CheckBoxComponent),\r\n        multi: true,\r\n    }]\r\n})\r\n\r\nexport class CheckBoxComponent implements ControlValueAccessor, OnInit {\r\n\r\n    @Input() id: string = '';\r\n    @Input() disabled: boolean = false;\r\n    @Input() value: string | number | boolean = '';\r\n    @Input() checkBoxGroup: Checkbox[];\r\n    model: boolean | any[];\r\n    onChange: (v: boolean | any[]) => void;\r\n    onTouched: () => void;\r\n\r\n    constructor() {}\r\n\r\n    ngOnInit(): void {\r\n        if (!this.checkBoxGroup) {\r\n            return;\r\n        }\r\n        this.model = [];\r\n        this.checkBoxGroup.forEach((ck: Checkbox) => {\r\n            if (ck.checked) {\r\n                (this.model as any).push(ck.value);\r\n            }\r\n        });\r\n    }\r\n    writeValue(obj: any): void {\r\n        this.model = obj;\r\n    }\r\n    registerOnChange(fn: any): void {\r\n        this.onChange = fn;\r\n    }\r\n    registerOnTouched(fn: any): void {\r\n        this.onTouched = fn;\r\n    }\r\n    myOnChange(v: any) {\r\n        if (!(this.model instanceof Array)) { // éæ°ç»ï¼è®¤ä¸ºæ¯å¸å°ç±»åï¼\r\n            this.onChange(v);\r\n            return;\r\n        }\r\n        const index = this.model.indexOf(v);\r\n        if (index > -1) {\r\n            this.model.splice(index, 1);\r\n        } else {\r\n            this.model.push(v);\r\n        }\r\n    }\r\n}\r\n\r\n/** åä¸ªcheckboxçéç½® */\r\nexport interface Checkbox {\r\n    /** value */\r\n    value: any;\r\n    /** æ¯å¦éä¸­ */\r\n    checked: any;\r\n    /** disabled */\r\n    disabled?: boolean;\r\n    /** æè¿° */\r\n    text?: string;\r\n}\r\n","/*\r\n * Created Date: Friday, August 21st 2020, 10:32:15 pm\r\n * Author: æ¨æµã®ççº¸\r\n * ---------------------------------------------------\r\n * Description: åéç»ç»ä»¶\r\n * ---------------------------------------------------\r\n * Last Modified: Saturday August 22nd 2020 11:29:49 am\r\n * Modified By: æ¨æµã®ççº¸\r\n * Contact: 1029512956@qq.com\r\n * Copyright (c) 2020 ZXWORK\r\n */\r\n\r\nimport { Component, Input, forwardRef } from '@angular/core';\r\nimport { ControlValueAccessor, NG_VALUE_ACCESSOR } from '@angular/forms';\r\n@Component({\r\n    selector: 'app-radio-group',\r\n    templateUrl: './radio-group.component.html',\r\n    providers: [{\r\n        provide: NG_VALUE_ACCESSOR,\r\n        useExisting: forwardRef(() => RadioGroupComponent),\r\n        multi: true,\r\n    }]\r\n})\r\nexport class RadioGroupComponent implements ControlValueAccessor {\r\n    @Input() radioGroup: Radio[] = [];\r\n    model: string | number | boolean;\r\n    onChange: (value: string) => void;\r\n    onTouched: () => void;\r\n\r\n    idPrefix() {\r\n        return 'z' + Math.random().toString().slice(2, 10);\r\n    }\r\n\r\n    constructor() { }\r\n\r\n    writeValue(obj: any): void {\r\n        this.model = obj;\r\n    }\r\n    registerOnChange(fn: any): void {\r\n        this.onChange = fn;\r\n    }\r\n    registerOnTouched(fn: any): void {\r\n        this.onTouched = fn;\r\n    }\r\n\r\n}\r\n\r\n/** åä¸ªradioçéç½® */\r\nexport interface Radio {\r\n    /** value */\r\n    value: any;\r\n    /** disabled */\r\n    disabled?: boolean;\r\n    /** æè¿° */\r\n    text?: string;\r\n}\r\n","/*\r\n * Created Date: Friday, August 21st 2020, 10:32:15 pm\r\n * Author: æ¨æµã®ççº¸\r\n * ---------------------------------------------------\r\n * Description: éç¨å·¥å·ç±»\r\n * ---------------------------------------------------\r\n * Last Modified: Saturday August 22nd 2020 11:36:21 am\r\n * Modified By: æ¨æµã®ççº¸\r\n * Contact: 1029512956@qq.com\r\n * Copyright (c) 2020 ZXWORK\r\n */\r\nexport default class CommonUtil {\r\n    /**\r\n     * æ ¹æ®åç´ idæ¾åç´ \r\n     * @param id åç´ id\r\n     */\r\n    static id(id: string) {\r\n        return document.getElementById(id);\r\n    }\r\n\r\n    /**\r\n     * å¤æ­æ¯å¦ie\r\n     */\r\n    static isIE() {\r\n        return !!((window as any).ActiveXObject || 'ActiveXObject' in window);\r\n    }\r\n\r\n    /**\r\n     * æ¾ä¸ä¸ä¸ªèç¹\r\n     * @param node èç¹\r\n     */\r\n    static preSibling(node: Node): Node {\r\n        let pre = node;\r\n        // tslint:disable-next-line: no-conditional-assignment curly\r\n        while ((pre = pre.previousSibling) && pre.nodeType !== 1);\r\n        return pre;\r\n    }\r\n\r\n    /**\r\n     * æ¾åç´ çææå­èç¹\r\n     * @param p ç¶åç´ \r\n     */\r\n    static getAllChilds(p: HTMLElement, arr: HTMLElement[] = []): HTMLElement[] {\r\n        arr.push(p);\r\n        // tslint:disable-next-line: curly\r\n        if (!p.children || !p.children.length) return arr;\r\n        Array.prototype.forEach.call(p.children, (child: HTMLElement) => {\r\n            arr = this.getAllChilds(child, arr);\r\n        });\r\n        return arr;\r\n    }\r\n\r\n    /**\r\n     * å¤æ­pæ¯å¦åå«c\r\n     * @param p åç´ \r\n     * @param c åç´ \r\n     */\r\n    static contains(p: HTMLElement, c: HTMLElement): boolean {\r\n        if (p.contains) { // firefoxä¸æ¯æ\r\n            return p.contains(c);\r\n        }\r\n        // æ¾pçææå­èç¹\r\n        const childs = this.getAllChilds(p);\r\n        for (let i = 0, len = childs.length; i < len; i++) {\r\n            // tslint:disable-next-line: curly\r\n            if (childs[i] === c) return true;\r\n        }\r\n        // tslint:disable-next-line: curly\r\n        if (p === c) return true;\r\n        return false;\r\n    }\r\n\r\n    /**\r\n     * ä»ä½å±æ¬¡å¾é«å±æ¬¡æ¾ç¬¬indexä¸ªç¶èç¹ï¼æ²¡æåè¿ånull\r\n     * @param  el ç®æ åç´ \r\n     * @param  index ç¬¬indexä¸ªç¶åç´ \r\n     */\r\n    static parent(el: HTMLElement, index: number = 1) {\r\n        let count = index + 1;\r\n        while (el && --count) {\r\n            // tslint:disable-next-line: no-angle-bracket-type-assertion\r\n            el = (<any> el.parentNode);\r\n        }\r\n        return el;\r\n    }\r\n    /**\r\n     * rgbé¢è²ä¸²è½¬ä»¥#å¼å¤´ç16è¿å¶é¢è²ä¸²\r\n     * @param str rgbé¢è²ä¸²\r\n     */\r\n    static rgbToHex(str: string) {\r\n        if (!str) { return ''; }\r\n        if (str.charAt(0) === '#') { return str; }\r\n        if (str.indexOf('rgb(') < 0) { return ''; }\r\n        str = str.slice(4, -1);\r\n        const arr = str.split(',');\r\n        let str$ = '#';\r\n        arr.forEach((num: string) => {\r\n            let dimStr = Number(num).toString(16);\r\n            dimStr = dimStr.length < 2 ? '0' + dimStr : dimStr;\r\n            str$ += dimStr;\r\n        });\r\n        return str$;\r\n    }\r\n\r\n    /**\r\n     * å°å¤ç»´æ°ç»åä¸ºä¸ç»´æ°ç»\r\n     * @param arr å¤ç»´æ°ç»\r\n     * @param box å®¹å¨\r\n     */\r\n    static flat(arr: Array<any>, box?: Array<any>) {\r\n        // tslint:disable-next-line: curly\r\n        if (!box) box = [];\r\n        for (let i = 0, len = arr.length; i < len; i++) {\r\n            const e = arr[i];\r\n            if (e instanceof Array) {\r\n                this.flat(e, box);\r\n                continue;\r\n            }\r\n            box.push(e);\r\n        }\r\n        return box;\r\n    }\r\n}\r\n","/*\r\n * Created Date: Friday, August 21st 2020, 10:32:15 pm\r\n * Author: æ¨æµã®ççº¸\r\n * ---------------------------------------------------\r\n * Description: åæ å·¥å·ç±»\r\n * ---------------------------------------------------\r\n * Last Modified: Saturday August 22nd 2020 11:36:44 am\r\n * Modified By: æ¨æµã®ççº¸\r\n * Contact: 1029512956@qq.com\r\n * Copyright (c) 2020 ZXWORK\r\n */\r\n\r\n/** æ§æ åRangeå¯¹è±¡ï¼åªååºå¸¸ç¨çä¸äºå±æ§åæ¹æ³ï¼ */\r\ninterface TextRange {\r\n    htmlText: string;\r\n    text: string;\r\n    pasteHTML(html: string): void;\r\n    collapse(isEnd: boolean): void;\r\n    move(type: 'charactor', offset: number): void;\r\n    moveEnd(type: 'charactor', offset: number): void;\r\n    moveStart(type: 'charactor', offset: number): void;\r\n    moveToElementText(node: HTMLElement | Node): void;\r\n    select(): void;\r\n    parentElement(): HTMLElement;\r\n}\r\n/**\r\n * éåºåèå´å·¥å·ç±»\r\n */\r\nexport default class CursorUtil {\r\n\r\n    /**\r\n     * è·åéåº\r\n     * @param  elem? è¦èç¦çåç´ ï¼å¦æå·²èç¦å¯ä¸ä¼ \r\n     * @returns Selection | TextRange\r\n     */\r\n    static getSelection(elem?: HTMLElement): Selection | TextRange {\r\n        let selection;\r\n        // tslint:disable-next-line: curly\r\n        if (elem && document.activeElement !== elem) elem.focus();\r\n        if (window.getSelection) {\r\n            selection = window.getSelection();\r\n        } else if (document.getSelection) {\r\n            selection = document.getSelection();\r\n        } else {\r\n            // tslint:disable-next-line: no-angle-bracket-type-assertion\r\n            selection = (<any> document).body.createRange();\r\n        }\r\n        return selection;\r\n    }\r\n\r\n\r\n    /**\r\n     * è®¾ç½®ç¬¬ä¸ä¸ªèå´\r\n     * @param  range èå´\r\n     */\r\n    static setFirstRange(range: Range | TextRange) {\r\n        const selection = this.getSelection();\r\n        // æ°æ å\r\n        // tslint:disable-next-line: no-angle-bracket-type-assertion\r\n        if ((<any> selection).addRange) {\r\n            // tslint:disable-next-line: no-angle-bracket-type-assertion\r\n            (<Selection> selection).removeAllRanges();\r\n            // tslint:disable-next-line: no-angle-bracket-type-assertion\r\n            (<Selection> selection).addRange(<Range> range);\r\n            return;\r\n        }\r\n        // æ§æ å\r\n        // tslint:disable-next-line: no-angle-bracket-type-assertion\r\n        (<TextRange> selection) = <TextRange> range;\r\n    }\r\n\r\n    /**\r\n     * è·åèå´\r\n     * @param  index èå´ä¸æ \r\n     * @param  elem? è¦èç¦çåç´ ï¼å¦æå·²èç¦å¯ä¸ä¼ \r\n     * @returns Range | TextRange \r\n     */\r\n    static getRange(index: number, elem?: HTMLElement): Range | TextRange {\r\n        const selection = this.getSelection(elem);\r\n        // tslint:disable-next-line: no-angle-bracket-type-assertion\r\n        if ((<Selection> selection).getRangeAt && (<Selection> selection).rangeCount) { // æ°æ å\r\n            // tslint:disable-next-line: no-angle-bracket-type-assertion\r\n            return (<Selection> selection).getRangeAt(index);\r\n        } else { // æ§æ å\r\n            // tslint:disable-next-line: no-angle-bracket-type-assertion\r\n            return (<TextRange> selection);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * éä¸­åç´ elemçåå®¹\r\n     */\r\n    static selectSelectionElementChilds(elem: HTMLElement) {\r\n        // tslint:disable-next-line: curly\r\n        if (!elem) return;\r\n        const selection = this.getSelection();\r\n        // tslint:disable-next-line: no-angle-bracket-type-assertion\r\n        if ((<any> selection).selectAllChildren) {\r\n            // tslint:disable-next-line: no-angle-bracket-type-assertion\r\n            (<Selection> selection).selectAllChildren(elem);\r\n            return;\r\n        }\r\n        // tslint:disable-next-line: no-angle-bracket-type-assertion\r\n        (<TextRange> selection).moveToElementText(elem);\r\n        // tslint:disable-next-line: no-angle-bracket-type-assertion\r\n        (<TextRange> selection).select();\r\n    }\r\n\r\n    /**\r\n     * è®¾ç½®éåºå°æä¸ªåç´ ï¼å¹¶æå \r\n     * @param  elem åç´ ï¼è¯¥åç´ å¯ä»¥æ¯ä¸å¯èç¦çåç´ \r\n     * @param isStart æ¯å¦æå å°å¼å¤´\r\n     */\r\n    static setSelectionToElement(elem: HTMLElement, isStart: boolean) {\r\n        this.selectSelectionElementChilds(elem);\r\n        const selection = this.getSelection();\r\n        // æ°æ å\r\n        // tslint:disable-next-line: no-angle-bracket-type-assertion\r\n        if (isStart && (<any> selection).collapseToStart) {\r\n            // tslint:disable-next-line: no-angle-bracket-type-assertion\r\n            (<Selection> selection).collapseToStart();\r\n            return;\r\n        }\r\n        // tslint:disable-next-line: no-angle-bracket-type-assertion\r\n        if (!isStart && (<any> selection).collapseToEnd) {\r\n            // tslint:disable-next-line: no-angle-bracket-type-assertion\r\n            (<Selection> selection).collapseToEnd();\r\n            return;\r\n        }\r\n        // æ§æ å\r\n        // tslint:disable-next-line: no-angle-bracket-type-assertion\r\n        (<TextRange> selection).collapse(!isStart);\r\n        // tslint:disable-next-line: no-angle-bracket-type-assertion\r\n        (<TextRange> selection).select();\r\n    }\r\n\r\n    /**\r\n     * è·åéåºçéä¸­çææ¬\r\n     * @returns string éåºææ¬\r\n     */\r\n    static getSelectionText(): string {\r\n        const selection = this.getSelection();\r\n        // tslint:disable-next-line: no-angle-bracket-type-assertion\r\n        return (<Selection> selection).toString() || (<TextRange> selection).text;\r\n    }\r\n    /**\r\n     * è·åä¸æ ä¸ºindexçèå´ææ¬\r\n     * @param  index ? èå´ä¸æ ï¼æ§æ åå°±åªæä¸ä¸ª\r\n     * @returns string\r\n     */\r\n    static getRangeText(index: number = 0): string {\r\n        const range = this.getRange(index);\r\n        // tslint:disable-next-line: no-angle-bracket-type-assertion\r\n        return (<Range> range).toString() || (<TextRange> range).text;\r\n    }\r\n\r\n    /**\r\n     * è·årangeèµ·å§ä½ç½®åç»æä½ç½®çææµçç¶åç´ \r\n     * \r\n     * æ¯å¦ï¼\\<p\\>(range-start)123(range-end)\\</p\\>çå¬å±ç¶åç´ ä¸ºtextï¼èä¸æ¯pæ ç­¾\r\n     * @param  index? å¯éï¼é»è®¤ç¬¬ä¸ä¸ªï¼æ§æ åå°±1ä¸ª\r\n     * @returns Node\r\n     */\r\n    static getRangeCommonParent(index: number = 0): Node | undefined {\r\n        const range = this.getRange(index);\r\n        // tslint:disable-next-line: no-angle-bracket-type-assertion\r\n        if ((<any> range).commonAncestorContainer) {\r\n            // tslint:disable-next-line: no-angle-bracket-type-assertion\r\n            return (<Range> range).commonAncestorContainer;\r\n        }\r\n        // tslint:disable-next-line: no-angle-bracket-type-assertion\r\n        if ((<any> range).parentElement) {\r\n            // tslint:disable-next-line: no-angle-bracket-type-assertion\r\n            return (<TextRange> range).parentElement();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * å é¤éä¸­åå®¹\r\n     * @param  index? rangeå¯¹è±¡ä¸æ ï¼é»è®¤0\r\n     */\r\n    static deleteRangeContent(index: number = 0) {\r\n        const range = this.getRange(index);\r\n        // tslint:disable-next-line: no-angle-bracket-type-assertion\r\n        if ((<any> range).deleteContents) {\r\n            // tslint:disable-next-line: no-angle-bracket-type-assertion\r\n            (<Range> range).deleteContents();\r\n            return;\r\n        }\r\n        // tslint:disable-next-line: no-angle-bracket-type-assertion\r\n        (<TextRange> range).pasteHTML('');\r\n        // tslint:disable-next-line: no-angle-bracket-type-assertion\r\n        (<TextRange> range).select();\r\n    }\r\n\r\n    /**\r\n     * æå¥èç¹\r\n     * @param  node èç¹\r\n     * @param  index? rangeå¯¹è±¡ä¸æ ï¼é»è®¤0\r\n     */\r\n    static insertNode(node: Node, index: number = 0) {\r\n        this.deleteRangeContent(index);\r\n        const range = this.getRange(index);\r\n        // tslint:disable-next-line: no-angle-bracket-type-assertion\r\n        if ((<any> range).insertNode) {\r\n            // tslint:disable-next-line: no-angle-bracket-type-assertion\r\n            (<Range> range).insertNode(node);\r\n            return;\r\n        }\r\n        // tslint:disable-next-line: no-angle-bracket-type-assertion\r\n        (<TextRange> range).pasteHTML((<HTMLElement> node).outerHTML);\r\n        // tslint:disable-next-line: no-angle-bracket-type-assertion\r\n        (<TextRange> range).select();\r\n    }\r\n}\r\n","/*\r\n * Created Date: Friday, August 21st 2020, 10:32:15 pm\r\n * Author: æ¨æµã®ççº¸\r\n * ---------------------------------------------------\r\n * Description: ç¼è¾å¨ç»ä»¶\r\n * ---------------------------------------------------\r\n * Last Modified: Saturday August 22nd 2020 11:37:23 am\r\n * Modified By: æ¨æµã®ççº¸\r\n * Contact: 1029512956@qq.com\r\n * Copyright (c) 2020 ZXWORK\r\n */\r\n\r\n// tslint:disable-next-line: max-line-length\r\nimport { Component, Input, ViewChild, OnInit, ElementRef, Renderer2, Output, EventEmitter, forwardRef, ViewEncapsulation } from '@angular/core';\r\nimport { ControlValueAccessor, NG_VALUE_ACCESSOR } from '@angular/forms';\r\nimport { WindowOptions } from './_alert/window/window';   // çªä½å¼¹çª\r\nimport { UILinkComponent } from './ui-link/ui-link';      // è¶é¾æ¥UIç»ä»¶\r\nimport { UITableComponent } from './ui-table/ui-table';   // è¡¨æ ¼UIç»ä»¶\r\nimport { UIAnnexComponent } from './ui-annex/ui-annex';   // éä»¶UIç»ä»¶\r\nimport { DomService } from './service/DomService';        // domæä¾å\r\nimport CommonUtil from './util/CommonUtil';               // domå·¥å·ç±»\r\nimport CursorUtil from './util/CursorUtil';               // åæ å·¥å·ç±»\r\n\r\n/** ç¼è¾å¨éç½®åæ° */\r\ninterface Options {\r\n    /** ç¼è¾åå®¹çæå¤§å­èæ° */\r\n    maxsize: number;\r\n    /** ä¸ä¼ è¶æ¶ ms */\r\n    timeout: number;\r\n    /** ä¸ä¼ å¾ççéç½®åæ° */\r\n    image: {\r\n        /** ä¸ä¼ çæå¤§å¾çæ°é */\r\n        count: number;\r\n        /** å°äºæå®å­èæ°ä¼è¿è¡base64ç¼ç  */\r\n        base64: number;\r\n    };\r\n    /** ä¸ä¼ è§é¢çéç½®åæ° */\r\n    video: {\r\n        /** ä¸ä¼ çæå¤§è§é¢æ°é */\r\n        count: number;\r\n    };\r\n    /** ä¸ä¼ é³é¢çéç½®åæ° */\r\n    music: {\r\n        /** ä¸ä¼ çæå¤§é³é¢æ°é */\r\n        count: number;\r\n    };\r\n}\r\n\r\n@Component({\r\n    selector: 'app-zeditor',\r\n    styleUrls: ['./ng-zeditor.component.scss'],\r\n    templateUrl: './ng-zeditor.component.html',\r\n    providers: [{\r\n        provide: NG_VALUE_ACCESSOR,\r\n        useExisting: forwardRef(() => AppZeditorComponent),\r\n        multi: true\r\n    }],\r\n    encapsulation: ViewEncapsulation.None\r\n})\r\nexport class AppZeditorComponent implements ControlValueAccessor, OnInit {\r\n    @Input()\r\n    set options(v: any) {\r\n        Object.assign(this.options$, v);\r\n    }\r\n    /** ç¼è¾æ¡ */\r\n    get header(): HTMLElement {\r\n        return this.headerRef.nativeElement;\r\n    }\r\n    /** ç¼è¾å¨ */\r\n    get editor(): HTMLElement {\r\n        return this.editorRef.nativeElement;\r\n    }\r\n    /** ç¼è¾é¢æ¿ */\r\n    get pannel(): HTMLElement {\r\n        return this.pannelRef.nativeElement;\r\n    }\r\n    get footer(): HTMLElement {\r\n        return (this.footerRef || {nativeElement: {offsetHeight: 0}}).nativeElement;\r\n    }\r\n    get fontNameEl(): HTMLElement {\r\n        return this.fontNameRef.nativeElement;\r\n    }\r\n    get fontSizeEl(): HTMLElement {\r\n        return this.fontSizeRef.nativeElement;\r\n    }\r\n    get formatBlockEl(): HTMLElement {\r\n        return this.formatBlockRef.nativeElement;\r\n    }\r\n    get foreColorEl(): HTMLElement {\r\n        return this.foreColorRef.nativeElement;\r\n    }\r\n    get backColorEl(): HTMLElement {\r\n        return this.backColorRef.nativeElement;\r\n    }\r\n    get codeEl(): HTMLElement {\r\n        return this.codeRef.nativeElement;\r\n    }\r\n\r\n    constructor(\r\n        private render2: Renderer2,\r\n        private domService: DomService\r\n    ) {\r\n    }\r\n    /** é»è®¤æ ¼å¼ */\r\n    static FORMAT = {\r\n        isBold: false,\r\n        isItalic: false,\r\n        isUnderline: false,\r\n        isStrikeThrough: false,\r\n        scriptActive: '',\r\n        formatBlock: 'p',\r\n        foreColor: '#000000',\r\n        backColor: '#ffffff',\r\n        justifyActive: 'justifyLeft',\r\n        fontSize: { key: 'small', value: '2', value$: '' },\r\n        fontFamily: { key: 'å¾®è½¯éé»', value: 'Microsoft Yahei' }\r\n    };\r\n    /** ä¼ å¥çhtml */\r\n    @Input() vhtml = '<p>è¯·è¾å¥åå®¹~</p>';\r\n    // tslint:disable-next-line: no-output-on-prefix\r\n    @Output() onInput: EventEmitter<string> = new EventEmitter<string>();\r\n    /** æ¯å¦ææé® */\r\n    @Input() hasBtn = false;\r\n    @Output() recieveContent: EventEmitter<any> = new EventEmitter<any>();\r\n    disabled: boolean;\r\n    /** åæ°éç½® */\r\n    options$: any = { maxsize: 65535, timeout: 10000, image: { count: 5, base64: 60000 }, audio: { count: 1 }, video: { count: 1 } };\r\n    /** ä¸»é¢ */\r\n    @Input() theme: 'r' | 'p' | 'b' | 'g' = 'g';\r\n    /** ä¸ä¼ æä»¶ */\r\n    @Output() uploadFile: EventEmitter<{}> = new EventEmitter<{}>();\r\n    /** ç¼è¾æ¡è§å¾å¼ç¨ */\r\n    @ViewChild('headerRef', { read: ElementRef, static: true }) headerRef: ElementRef;\r\n    /** ç¼è¾å¨æ´ä½è§å¾å¼ç¨ */\r\n    @ViewChild('editorRef', { read: ElementRef, static: true }) editorRef: ElementRef;\r\n    /** pannelè§å¾å¼ç¨ */\r\n    @ViewChild('pannelRef', { read: ElementRef, static: true }) pannelRef: ElementRef;\r\n    @ViewChild('footerRef', { read: ElementRef, static: true }) footerRef: ElementRef;\r\n    @ViewChild('fontNameRef', { read: ElementRef, static: true }) fontNameRef: ElementRef;\r\n    @ViewChild('fontSizeRef', { read: ElementRef, static: true }) fontSizeRef: ElementRef;\r\n    @ViewChild('formatBlockRef', { read: ElementRef, static: true }) formatBlockRef: ElementRef;\r\n    @ViewChild('foreColorRef', { read: ElementRef, static: true }) foreColorRef: ElementRef;\r\n    @ViewChild('backColorRef', { read: ElementRef, static: true }) backColorRef: ElementRef;\r\n    @ViewChild('codeRef', { read: ElementRef, static: true }) codeRef: ElementRef;\r\n    /** å­ä½æ ·å¼ */\r\n    // tslint:disable-next-line: max-line-length\r\n    fontFamilys = [{ key: 'arial', value: 'arial' }, { key: 'å¾®è½¯éé»', value: 'Microsoft Yahei' }, { key: 'å®ä½', value: 'SimSun' }, { key: 'é»ä½', value: 'SimHei' }, { key: 'æ¥·ä½', value: 'KaiTi' }, { key: 'å®ä½', value: 'SimSun' }, { key: 'æ°å®ä½', value: 'NSimSun' }, { key: 'ä»¿å®', value: 'FangSong' }, { key: 'å¾®è½¯æ­£é»ä½', value: 'Microsoft JhengHei' }, { key: 'åæç¥ç', value: 'STHupo' }, { key: 'åæå½©äº', value: 'STCaiyun' }, { key: 'å¹¼å', value: 'YouYuan' }, { key: 'åæè¡æ¥·', value: 'STXingkai' }];\r\n    /** ææ¬æ ¼å¼ */\r\n    // tslint:disable-next-line: max-line-length\r\n    formatBlocks = [{ key: 'p', value: '<p data-index=\"0\">p</p>' }, { key: 'h6', value: '<h6 data-index=\"1\">h6</h6>' }, { key: 'h5', value: '<h5 data-index=\"2\">h5</h5>' }, { key: 'h4', value: '<h4 data-index=\"3\">h4</h4>' }, { key: 'h3', value: '<h3 data-index=\"4\">h3</h3>' }, { key: 'h2', value: '<h2 data-index=\"5\">h2</h2>' }, { key: 'h1', value: '<h1 data-index=\"6\">h1</h1>' }];\r\n    /** é¢è² */\r\n    // tslint:disable-next-line: max-line-length\r\n    colors = [['#ffffff', '#000000', '#eeece1', '#1f497d', '#4f81bd', '#c0504d', '#9bbb59', '#8064a2', '#4bacc6', '#f79646'], ['#f2f2f2', '#7f7f7f', '#ddd9c3', '#c6d9f0', '#dbe5f1', '#f2dcdb', '#ebf1dd', '#e5e0ec', '#dbeef3', '#fdeada'], ['#d8d8d8', '#595959', '#c4bd97', '#8db3e2', '#b8cce4', '#e5b9b7', '#d7e3bc', '#ccc1d9', '#b7dde8', '#fbd5b5'], ['#bfbfbf', '#3f3f3f', '#938953', '#548dd4', '#95b3d7', '#d99694', '#c3d69b', '#b2a2c7', '#92cddc', '#fac08f'], ['#a5a5a5', '#262626', '#494429', '#17365d', '#366092', '#953734', '#76923c', '#5f497a', '#31859b', '#e36c09'], ['#7f7f7f', '#0c0c0c', '#1d1b10', '#0f243e', '#244061', '#632423', '#4f6128', '#3f3151', '#205867', '#974806'], ['#c00000', '#ff0000', '#ffc000', '#ffff00', '#92d050', '#00b050', '#00b0f0', '#0070c0', '#002060', '#7030a0']];\r\n    /** å­ä½å¤§å° */\r\n    // tslint:disable-next-line: max-line-length\r\n    fontSizes = [{ key: 'x-small', value: '1', value$: 10 / 16 }, { key: 'small', value: '2', value$: 12 / 16 }, { key: 'medium', value: '3', value$: 16 / 16 }, { key: 'large', value: '4', value$: 18 / 16 }, { key: 'x-large', value: '5', value$: 24 / 16 }, { key: 'xx-large', value: '6', value$: 32 / 16 }, { key: 'xxx-large', value: '7', value$: 48 / 16 }];\r\n    /** code */\r\n    codes = ['Html', 'Css', 'Javascript', 'TypeScript', 'Sass', 'Java', 'Xml', 'Sql', 'Shell'];\r\n    /** éä¸­çå­æ · */\r\n    fontFamily: any = { key: 'å¾®è½¯éé»', value: 'Microsoft Yahei' };\r\n    /** éä¸­çå­å· */\r\n    fontSize: any = { key: 'small', value: 2, value$: 12 / 16 }; // é»è®¤.75rem;\r\n    /** ææ¬æ ¼å¼ */\r\n    formatBlock = 'p';\r\n    /** å­ä½é¢è² */\r\n    foreColor = 'black';\r\n    /** é«äº®è² */\r\n    backColor = 'white';\r\n    /** å½åä»£ç è¯­è¨ */\r\n    code = 'Javascript';\r\n    /** æ¯å¦æå¼å­æ ·é¢æ¿ */\r\n    switchFontFamilyPannel = false;\r\n    /** æ¯å¦æå¼å­å·é¢æ¿ */\r\n    switchFontSizePannel = false;\r\n    /** æ¯å¦æå¼ææ¬æ ¼å¼é¢æ¿ */\r\n    switchFormatBlockPannel = false;\r\n    /** æ¯å¦æå¼å­ä½é¢è²é¢æ¿ */\r\n    switchForeColorPannel = false;\r\n    /** æ¯å¦æå¼èæ¯è²é¢æ¿ */\r\n    switchBackColorPannel = false;\r\n    /** æ¯å¦æå¼ä»£ç è¯­è¨é¢æ¿ */\r\n    switchCodePannel = false;\r\n    /** æ¯å¦å ç² */\r\n    isBold = false;\r\n    /** æ¯å¦æä½ */\r\n    isItalic = false;\r\n    /** æ¯å¦ä¸åçº¿ */\r\n    isUnderline = false;\r\n    /** æ¯å¦å é¤çº¿ */\r\n    isStrikeThrough = false;\r\n    /** é»è®¤æ ä¸ä¸æ  */\r\n    scriptActive = '';\r\n    /** é»è®¤å·¦å¯¹é½ */\r\n    justifyActive = 'justifyLeft';\r\n    /** æ¯å¦å¤äºç¼è¾ç¶æä¸­ */\r\n    isInEditStatus = false;\r\n    /** è®°ä½çrange */\r\n    range: any;\r\n    /** æ¯å¦å¨å±, é»è®¤false */\r\n    full = false;\r\n    /** ç¶åç´  */\r\n    parent!: HTMLElement;\r\n    /** æ¯å¦å¨ä»£ç åº, é»è®¤false */\r\n    inCode = false;\r\n    onChange: (html: string) => void = () => undefined;\r\n    onTouched: () => void = () => undefined;\r\n    writeValue(obj: any): void {\r\n        if (obj !== undefined) {\r\n            this.vhtml = obj;\r\n        }\r\n    }\r\n    registerOnChange(fn: any): void {\r\n        this.onChange = fn;\r\n    }\r\n    registerOnTouched(fn: any): void {\r\n        this.onTouched = fn;\r\n    }\r\n    setDisabledState(isDisabled: boolean): void {\r\n        this.disabled = isDisabled;\r\n    }\r\n    ngOnInit(): void {\r\n        this.initFormatData();\r\n        this.parent = this.render2.parentNode(this.editor);\r\n    }\r\n    /**\r\n     * åå§åé»è®¤æ ¼å¼\r\n     */\r\n    initFormatData() {\r\n        Object.assign(this, AppZeditorComponent.FORMAT);\r\n    }\r\n\r\n    /**\r\n     * å¦æé¢æ¿ä¸èç¦åä½¿é¢æ¿èç¦\r\n     */\r\n    pannelFocus() {\r\n        if (document.activeElement !== this.pannel) {\r\n            this.pannel.focus();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * è®¾ç½®å­æ ·\r\n     * @param e äºä»¶\r\n     */\r\n    setFontName(e: any) {\r\n        this.ensureFocus(e);\r\n        const t = e.target;\r\n        const index = t.getAttribute('data-index');\r\n        this.switchFontFamilyPannel = !this.switchFontFamilyPannel;\r\n        if (index === null || index === undefined) { return; }\r\n        this.fontFamily = this.fontFamilys[index * 1];\r\n        this.cmd('fontName', false, this.fontFamily.value);\r\n    }\r\n\r\n    /**\r\n     * è®¾ç½®å­å·\r\n     */\r\n    setFontSize(e: any) {\r\n        this.ensureFocus(e);\r\n        const t = e.target;\r\n        const index = t.getAttribute('data-index');\r\n        this.switchFontSizePannel = !this.switchFontSizePannel;\r\n        if (index === null || index === undefined) { return; }\r\n        const fontSize = this.fontSizes[index * 1];\r\n        this.fontSize = fontSize;\r\n        this.cmd('fontSize', false, fontSize.value);\r\n    }\r\n\r\n    /**\r\n     * è®¾ç½®ææ¬æ ¼å¼\r\n     * @param e äºä»¶\r\n     */\r\n    setFormatBlock(e: any) {\r\n        this.ensureFocus(e);\r\n        const t = e.target;\r\n        const index = t.getAttribute('data-index');\r\n        this.switchFormatBlockPannel = !this.switchFormatBlockPannel;\r\n        if (index === null || index === undefined) { return; }\r\n        const formatBlock = this.formatBlocks[index * 1];\r\n        this.formatBlock = formatBlock.key;\r\n        this.cmd('formatBlock', false, '<' + this.formatBlock + '>');\r\n    }\r\n\r\n    /**\r\n     * è®¾ç½®åæ¯è²\r\n     * @param e äºä»¶\r\n     */\r\n    setForeColor(e: any) {\r\n        this.ensureFocus(e);\r\n        const t = e.target;\r\n        const x = t.getAttribute('data-dim1');\r\n        const y = t.getAttribute('data-dim2');\r\n        this.switchForeColorPannel = !this.switchForeColorPannel;\r\n        if (x === null || y == null) { return; }\r\n        this.foreColor = this.colors[x][y];\r\n        this.cmd('foreColor', false, this.foreColor);\r\n    }\r\n\r\n    /**\r\n     * è®¾ç½®èæ¯è²(é«äº®è²)\r\n     * @param e äºä»¶\r\n     */\r\n    setBackColor(e: any) {\r\n        this.ensureFocus(e);\r\n        const t = e.target;\r\n        const x = t.getAttribute('data-dim1');\r\n        const y = t.getAttribute('data-dim2');\r\n        this.switchBackColorPannel = !this.switchBackColorPannel;\r\n        if (x === null || y == null) { return; }\r\n        this.backColor = this.colors[x][y];\r\n        this.cmd('backColor', false, this.backColor);\r\n    }\r\n\r\n    /**\r\n     * è®¾ç½®ä»£ç è¯­è¨\r\n     * @param e äºä»¶\r\n     */\r\n    insertCode(e: any) {\r\n        this.ensureFocus(e);\r\n        this.switchCodePannel = !this.switchCodePannel;\r\n        const index = e.target.getAttribute('data-index');\r\n        if (index === null) { return; }\r\n        this.code = this.codes[index];\r\n        const code = this.code.toLowerCase();\r\n        const id = (Math.random() + '').slice(2, 8);\r\n        const html = `<pre style=\"white-space:pre;\" title=\"ä»£ç åº\"><code class=\"${code}\"><p id=\"${id}\"><br/></p></code></pre><p><br/></p>`;\r\n        this.cmd('insertHTML', false, html);\r\n        // æå¥htmlåï¼å°åæ ç§»è³ä»£ç åºçpæ ç­¾ä¸­\r\n        // tslint:disable-next-line: no-angle-bracket-type-assertion\r\n        CursorUtil.setSelectionToElement(<any>(CommonUtil.id(id)), true);\r\n        this.setRange(); // æå¨è®°å½ä¸ä¸åæ ä½ç½®\r\n    }\r\n\r\n    /**\r\n     * è¡åæ¢è¡ï¼shift+enterï¼\r\n     * @param e äºä»¶\r\n     */\r\n    insertBrOnReturn(e: any) {\r\n        this.ensureFocus(e);\r\n        if (!this.isSupport('insertBrOnReturn')) {\r\n            this.cmd('insertHTML', false, '<br><br>');\r\n            return;\r\n        }\r\n        this.cmd('insertBrOnReturn', false);\r\n    }\r\n\r\n    /**\r\n     * è®¾ç½®ç²ä½\r\n     */\r\n    switchBold(e: any) {\r\n        this.ensureFocus(e);\r\n        this.cmd('bold', false, '');\r\n        this.isBold = !this.isBold;\r\n    }\r\n\r\n    /**\r\n     * è®¾ç½®æä½\r\n     */\r\n    switchItalic(e: any) {\r\n        this.ensureFocus(e);\r\n        this.cmd('italic', false, '');\r\n        this.isItalic = !this.isItalic;\r\n    }\r\n\r\n    /**\r\n     * è®¾ç½®ä¸åçº¿\r\n     */\r\n    switchUnderline(e: any) {\r\n        this.ensureFocus(e);\r\n        this.cmd('underline', false, '');\r\n        this.isUnderline = !this.isUnderline;\r\n    }\r\n\r\n    /**\r\n     * è®¾ç½®å é¤çº¿\r\n     */\r\n    switchStrikeThrough(e: any) {\r\n        this.ensureFocus(e);\r\n        this.cmd('strikeThrough', false, '');\r\n        this.isStrikeThrough = !this.isStrikeThrough;\r\n    }\r\n\r\n    /**\r\n     * è®¾ç½®/åæ¶ä¸/ä¸æ \r\n     */\r\n    setScript(e: Event, cmd: 'superscript' | 'subscript') {\r\n        this.ensureFocus(e);\r\n        if (this.scriptActive === cmd) {\r\n            this.cmd(cmd, false, '');\r\n            this.scriptActive = '';\r\n            return;\r\n        }\r\n        this.scriptActive = cmd;\r\n        this.cmd(cmd, false, '');\r\n    }\r\n\r\n    /**\r\n     * è®¾ç½®æå­å¯¹é½æ¹å\r\n     * @param  e äºä»¶\r\n     */\r\n    setJustifyactive(e: Event, str: 'Left' | 'Right' | 'Center' | 'Full') {\r\n        this.ensureFocus(e);\r\n        this.justifyActive = 'justify' + str;\r\n        this.cmd(this.justifyActive, false);\r\n    }\r\n\r\n    /**\r\n     * ç¼©è¿\r\n     */\r\n    indent(e: any) {\r\n        this.ensureFocus(e);\r\n        this.cmd('indent', false, '');\r\n    }\r\n\r\n    /**\r\n     * åå°ç¼©è¿\r\n     */\r\n    outdent(e: any) {\r\n        this.ensureFocus(e);\r\n        this.cmd('outdent', false, '');\r\n    }\r\n\r\n    /**\r\n     * æå¥æåºåè¡¨\r\n     */\r\n    insertOrderedList(e: any) {\r\n        this.ensureFocus(e);\r\n        this.cmd('insertOrderedList', false, '');\r\n    }\r\n\r\n    /**\r\n     * æå¥æ åºåè¡¨\r\n     */\r\n    insertUnorderedList(e: any) {\r\n        this.ensureFocus(e);\r\n        this.cmd('insertUnorderedList', false, '');\r\n    }\r\n\r\n    /**\r\n     * æå¥è¡¨æ ¼è°èµ·æå¥è¡¨æ ¼UI\r\n     */\r\n    insertTable(e: any) {\r\n        this.alert({ title: 'æå¥è¡¨æ ¼', animation: 'scale', content: UITableComponent, handler: this, theme: this.theme });\r\n    }\r\n    /**\r\n     * ç¹å»è¡¨æ ¼UIå¼¹çªç¡®è®¤æ¶åè°\r\n     * @param html æå¥çhtml\r\n     */\r\n    recieveTableHTML(html: string) {\r\n        this.startEdit();\r\n        this.cmd('insertHTML', false, html);\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * æå¥è¶é¾æ¥è°èµ·æå¥è¶é¾æ¥UI\r\n     * @param e äºä»¶\r\n     */\r\n    insertLink(e: any) {\r\n        this.alert({ title: 'æå¥é¾æ¥', animation: 'scale', content: UILinkComponent, handler: this, theme: this.theme });\r\n    }\r\n    /**\r\n     * ç¹å»è¶é¾æ¥UIå¼¹çªç¡®è®¤æ¶åè°\r\n     * @param html æå¥çhtml\r\n     */\r\n    recieveLinkHTML(html: string) {\r\n        this.startEdit();\r\n        this.cmd('insertHTML', false, html);\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * æå¥å¾çè°èµ·æå¥å¾çUI\r\n     * @param e äºä»¶\r\n     */\r\n    insertFile(e: any) {\r\n        this.alert({ title: 'æå¥æä»¶', animation: 'scale', content: UIAnnexComponent, handler: this, theme: this.theme });\r\n    }\r\n    /**\r\n     * ç¹å»ä¸ä¼ æä»¶UIå¼¹çªä¸ä¼ æ¬å°æä»¶æ¶åµå¥base64æ¶åè°\r\n     * @param html æå¥çhtml\r\n     */\r\n    recieveLocalFileHTML(html: string) {\r\n        this.startEdit();\r\n        this.cmd('insertHTML', false, html);\r\n        return true;\r\n    }\r\n    /**\r\n     * ç¹å»ä¸ä¼ æä»¶UIå¼¹çªâæå¥å¤é¾âæ¶åè°\r\n     * @param html æå¥çhtml\r\n     */\r\n    recieveFileLinkHTML(html: string) {\r\n        this.startEdit();\r\n        this.cmd('insertHTML', false, html);\r\n        return true;\r\n    }\r\n    /**\r\n     * åå°éæ©æä»¶äºä»¶\r\n     * @param  type æä»¶ç±»å\r\n     * @param  file æä»¶\r\n     * @param  parser ä¼ å¥srcè·åhtml\r\n     * @param  close  å³é­å¼¹çªåé®ç½©\r\n     */\r\n    emitUploadFile(type: 'image' | 'audio' | 'video', file: any, parser: (v: string) => string, close: (b: boolean, t?: number) => void) {\r\n        this.uploadFile.emit({\r\n            type, file, callback: (src: string | boolean, t?: number) => {\r\n                if (!!src) {\r\n                    this.recieveFileLinkHTML(parser(src as string));\r\n                }\r\n                close(!!src, t);\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * æå¥hr\r\n     */\r\n    insertHorizontalRule(e: any) {\r\n        this.ensureFocus(e);\r\n        this.cmd('insertHorizontalRule', false, '');\r\n    }\r\n\r\n    /**\r\n     * ç²è´´\r\n     */\r\n    paste(e: any) {\r\n        this.ensureFocus(e);\r\n        this.cmd('paste', false, '');\r\n    }\r\n\r\n    /**\r\n     * åªå\r\n     */\r\n    cut(e: any) {\r\n        this.ensureFocus(e);\r\n        this.cmd('cut', false, '');\r\n    }\r\n\r\n    /**\r\n     * å¤å¶\r\n     */\r\n    copy(e: any) {\r\n        this.ensureFocus(e);\r\n        this.cmd('copy', false, '');\r\n    }\r\n\r\n    /**\r\n     * éä¸­ææ\r\n     */\r\n    selectAll(e: any) {\r\n        this.ensureFocus(e);\r\n        this.cmd('selectAll', false, '');\r\n    }\r\n\r\n    /**\r\n     * éå\r\n     */\r\n    redo(e: any) {\r\n        this.ensureFocus(e);\r\n        this.cmd('redo', false, '');\r\n    }\r\n\r\n    /**\r\n     * æ¤é\r\n     */\r\n    undo(e: any) {\r\n        this.ensureFocus(e);\r\n        this.cmd('undo', false, '');\r\n    }\r\n\r\n    /**\r\n     * å é¤éä¸­\r\n     */\r\n    deleteSelect(e: any) {\r\n        this.ensureFocus(e);\r\n        this.cmd('delete', false, '');\r\n    }\r\n\r\n    /**\r\n     * è·ååå²è¾å¥\r\n     */\r\n    history(e: Event) {\r\n        this.ensureFocus(e);\r\n        this.vhtml = window.localStorage.getItem('editor_input') || '';\r\n        this.autoActive();\r\n        this.setRangeAndEmitValue(0);\r\n    }\r\n\r\n    /**\r\n     * æ¸é¤æ ¼å¼ï¼ä¸é»æ­¢å¤±ç¦ï¼éæ°èç¦æ¶ä¼è®¾ç½®åå²æ ¼å¼\r\n     */\r\n    removeFormat() {\r\n        this.cmd('removeFormat', false);\r\n        this.initFormatData();\r\n        this.setDefaultFormat();\r\n    }\r\n\r\n    /**\r\n     * éèåç±»ä¸ææ¡\r\n     * @param e äºä»¶\r\n     */\r\n    hideSwitchPannel(e: any) {\r\n        const target = e.target || e.srcElement;\r\n        if (this.switchFontFamilyPannel && !CommonUtil.contains(this.fontNameEl, target)) {\r\n            this.switchFontFamilyPannel = false;\r\n            return;\r\n        }\r\n        if (this.switchFontSizePannel && !CommonUtil.contains(this.fontSizeEl, target)) {\r\n            this.switchFontSizePannel = false;\r\n            return;\r\n        }\r\n        if (this.switchForeColorPannel && !CommonUtil.contains(this.foreColorEl, target)) {\r\n            this.switchForeColorPannel = false;\r\n            return;\r\n        }\r\n        if (this.switchBackColorPannel && !CommonUtil.contains(this.backColorEl, target)) {\r\n            this.switchBackColorPannel = false;\r\n            return;\r\n        }\r\n        if (this.switchFormatBlockPannel && !CommonUtil.contains(this.formatBlockEl, target)) {\r\n            this.switchFormatBlockPannel = false;\r\n            return;\r\n        }\r\n        if (this.switchCodePannel && !CommonUtil.contains(this.codeEl, target)) {\r\n            this.switchCodePannel = false;\r\n            return;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * å¨å±æåæ¶å¨å±\r\n     */\r\n    SwitchScreen() {\r\n        const editor: any = this.editor;\r\n        const header: any = this.header;\r\n        const pannel: any = this.pannel;\r\n        const footer: any = this.footer;\r\n        this.full = !this.full;\r\n        if (this.full) { // å¨å±\r\n            editor.style.cssText = 'position:fixed;z-index:99999;top:0;left:0;transform:none;width:100%;height:100%;';\r\n            pannel.style.cssText = `max-height:unset;height:${window.innerHeight - header.offsetHeight - footer.offsetHeight}px;`;\r\n            document.body.appendChild(editor);\r\n        } else {        // è¿å\r\n            editor.style.cssText = '';\r\n            pannel.style.cssText = '';\r\n            this.parent.appendChild(editor);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * çå¬æé®äºä»¶ (å¤çtabç¼©è¿)\r\n     * @param e æé®äºä»¶\r\n     */\r\n    keydown(e: Event | any) {\r\n        const key = e.keyCode || e.which || e.charCode;\r\n        if (key !== 9) {\r\n            return;\r\n        }\r\n        // æä¸tabé®ï¼å¢å ç¼©è¿2ä¸ªç©ºæ ¼\r\n        const tab = new Array(5).join('&nbsp;');\r\n        this.cmd('insertHTML', false, tab);\r\n        e.preventDefault();\r\n        return;\r\n    }\r\n\r\n    /**\r\n     * çå¬æé®å¼¹èµ·äºä»¶\r\n     * @param e æé®å¼¹èµ·äºä»¶\r\n     */\r\n    keyup(e: Event | any) {\r\n        this.setRange();\r\n        if (this.isRangeInCode()) { return; }\r\n        // tslint:disable-next-line: deprecation\r\n        e = e || window.event;\r\n        const key = e.keyCode || e.which || e.charCode;\r\n        // çå¬home,endåä¸ä¸å·¦å³æé®ï¼æåéé®æå é¤é®æenteré®ï¼è®¾ç½®æ¿æ´»æå­æ ¼å¼\r\n        if ((key >= 35 && key <= 40) || key === 8 || key === 46 || key === 13) {\r\n            this.autoActive();\r\n            return;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * ç¹å»é¢æ¿\r\n     */\r\n    pannelOnClick() {\r\n        this.initEdit();\r\n        this.setRange();\r\n        this.autoActive();\r\n    }\r\n\r\n    /**\r\n     * å¨ç¼è¾é¢æ¿ä¸­ç²è´´ï¼è¥å¨ä»£ç åºåç²è´´åæ¸é¤æ ¼å¼ï¼ï¼ï¼ï¼\r\n     */\r\n    pannelOnPaste(e: any) {\r\n        setTimeout(() => { this.autoActive(); });\r\n        if (!this.isRangeInCode()) {\r\n            // tslint:disable-next-line: no-angle-bracket-type-assertion\r\n            const obj = <any> CommonUtil.isIE() ? window : e;\r\n            if (!obj.clipboardData) { return; }\r\n            const text = obj.clipboardData.getData('text');\r\n            const df = document.createDocumentFragment();\r\n            df.appendChild(document.createTextNode(text));\r\n            CursorUtil.insertNode(df);\r\n            e.preventDefault();\r\n            e.returnValue = false;\r\n        }\r\n        this.setRangeAndEmitValue(0);\r\n    }\r\n\r\n    /**\r\n     * è¾å¥æ¶è®°ä½ååä½ç½® && inputäºä»¶åå°value && è®°ä½è¾å¥\r\n     */\r\n    setRangeAndEmitValue(arg0: number | Event) {\r\n        if (typeof arg0 !== 'number') {\r\n            arg0 = 300;\r\n        }\r\n        this.setRange();\r\n        this.debounce(() => {\r\n            const innerHTML = this.pannel.innerHTML;\r\n            if (this.vhtml === innerHTML) { return; }\r\n            // æåå®¹æ¶æä¿å­å°æ¬å°\r\n            const len = (this.pannel.innerText || this.pannel.textContent).length;\r\n            if (len > 1) {\r\n                window.localStorage.setItem('editor_input', innerHTML);\r\n            }\r\n            // 1.åå°innerHTML,inputäºä»¶æ¥æ¶\r\n            this.onInput.emit(innerHTML);\r\n            // 2.è§¦ångModelChangeäºä»¶\r\n            this.onChange(innerHTML);\r\n        }, arg0);\r\n    }\r\n\r\n    /**\r\n     * åå°ç¼è¾åå®¹\r\n     */\r\n    emitContent() {\r\n        let size = 0;\r\n        const editPannel = this.pannel as any;\r\n        // æ£æµç¼è¾åå®¹å¤§å°\r\n        let innerHTML: string = editPannel.innerHTML;\r\n        for (let i = 0, len = innerHTML.length; i < len; i++) {\r\n            const c = innerHTML.charCodeAt(i);\r\n            if (c > 0 && c < 255) {\r\n                size++;\r\n            } else {\r\n                size += 2;\r\n            }\r\n        }\r\n        if (size > this.options$.maxsize) {\r\n            this.toast('ç¼è¾åå®¹è¶åºå¤§å°~');\r\n            innerHTML = innerHTML.substr(0, this.options$.maxsize);\r\n        }\r\n        const image = this.getUrlsByTag(this.pannel, 'img');\r\n        const audio = this.getUrlsByTag(this.pannel, 'audio');\r\n        const video = this.getUrlsByTag(this.pannel, 'video');\r\n        const obj = {\r\n            innerHTML,\r\n            innerTEXT: editPannel.innerText || editPannel.textContent,\r\n            urls: { image, audio, video }\r\n        };\r\n        this.recieveContent.emit(obj);\r\n    }\r\n\r\n    /**\r\n     * ç¡®ä¿ç¼è¾é¢æ¿èç¦ï¼è®¾ç½®ç¼è¾é¢æ¿ä¸æ¬¡åæ ä¸ºå½ååæ \r\n     */\r\n    private recoverRange() {\r\n        if (!this.pannel) { return; }\r\n        // ç¡®ä¿ç¼è¾é¢æ¿åæ¯èç¦ç\r\n        if (document.activeElement !== this.pannel) {\r\n            this.pannel.focus();\r\n        }\r\n        if (this.range) { // å­å¨ä¸æ¬¡åæ ï¼åè®¾ç½®ä¸æ¬¡åæ \r\n            CursorUtil.setFirstRange(this.range);\r\n            return;\r\n        }\r\n        CursorUtil.setSelectionToElement(this.pannel, false);\r\n    }\r\n\r\n    /**\r\n     * 1.èç¦é¢æ¿å¹¶è·åä¸æ¬¡åæ ä½ç½®,è®¾ç½®å½ååå²ç¼è¾æ ·å¼\r\n     * 2.ç¹å»ç¼è¾æ¡çå½ä»¤æèç¼è¾é¢æ¿åï¼å°è§ä¸ºç¼è¾ç¶æ\r\n     * @param  recover? æ¯å¦éè¦æ¢å¤ä¸æ¬¡åæ \r\n     */\r\n    private startEdit(recover: boolean = true) {\r\n        // æ¢å¤ä¸æ¬¡åæ ï¼ç¹å»ç¼è¾é¢æ¿ä¸éè¦æ¢å¤ä¸æ¬¡åæ ï¼ç¹å»ç¼è¾æ¡éè¦æ¢å¤ä¸æ¬¡åæ ï¼\r\n        if (recover) {\r\n            this.recoverRange();\r\n        }\r\n        this.initEdit();\r\n    }\r\n\r\n    /**\r\n     * é»æ­¢é»è®¤äºä»¶é²æ­¢å¤±ç¦ï¼ç¡®ä¿ç¼è¾é¢æ¿èç¦ï¼è®¾ç½®åå²åæ åæ ¼å¼\r\n     * @param e äºä»¶å¯¹è±¡\r\n     */\r\n    private ensureFocus(e: Event) {\r\n        // é»æ­¢å¤±ç¦\r\n        e.preventDefault();\r\n        // ç¼è¾åå§å\r\n        this.startEdit();\r\n    }\r\n\r\n    /**\r\n     * ç¼è¾åå§ååè®¾ç½®åå²æ ¼å¼\r\n     */\r\n    private initEdit() {\r\n        // å¨ç¼è¾ç¶æä¸åæ¬¡è¿è¡åå§å\r\n        if (this.isInEditStatus) {\r\n            return;\r\n        }\r\n        // æ è®°é¢æ¿å¤äºç¼è¾ç¶æ\r\n        if (!this.isInEditStatus) {\r\n            this.isInEditStatus = true;\r\n        }\r\n        // å¨ä»£ç åºä¸è®¾ç½®é»è®¤æ ¼å¼\r\n        if (this.isRangeInCode()) {\r\n            return;\r\n        }\r\n        // å¦æåæ å¨å´æåå®¹åä¸è®¾ç½®é»è®¤æ ¼å¼\r\n        const el = CursorUtil.getRangeCommonParent();\r\n        if (!el || el.nodeType === 3) {\r\n            return;\r\n        }\r\n        // å¦ææ²¡æåå®¹ï¼åæ ¼å¼åé»è®¤æ ¼å¼\r\n        if (!this.pannel.children || !this.pannel.children.length) {\r\n            this.setDefaultFormat();\r\n        }\r\n    }\r\n\r\n    setDefaultFormat() {\r\n        this.cmd('formatBlock', false, this.formatBlock);\r\n        this.cmd('fontName', false, this.fontFamily.value);\r\n        this.cmd('fontSize', false, this.fontSize.value);\r\n    }\r\n\r\n    /**\r\n     * æ¥è¯¢æ¯å¦æ¯æå½ä»¤\r\n     * @param cmd å½ä»¤\r\n     */\r\n    private isSupport(cmd: string): boolean {\r\n        return document.queryCommandSupported(cmd);\r\n    }\r\n\r\n    /**\r\n     * å¼å®¹insertHTMLå½ä»¤\r\n     * @param html html\r\n     */\r\n    private insertHTML(html: string) {\r\n        // tslint:disable-next-line: no-angle-bracket-type-assertion\r\n        const range = <Range>CursorUtil.getRange(0);\r\n        range.deleteContents();\r\n        const df = document.createDocumentFragment();\r\n        let name = 'div';\r\n        if (html.indexOf('<a>') > -1) { name = 'span'; }\r\n        const el = document.createElement(name);\r\n        el.innerHTML = html;\r\n        df.appendChild(el);\r\n        range.insertNode(df);\r\n        return true;\r\n    }\r\n\r\n    /**\r\n     * æ§è¡å°è£çç¼è¾å½ä»¤\r\n     * @param k å½ä»¤åç§°\r\n     * @param ui æå¼uiå¼¹çª\r\n     * @param v è®¾ç½®å½ä»¤å¼\r\n     * @returns true-è®¾ç½®æåï¼false-è®¾ç½®å¤±è´¥\r\n     */\r\n    private cmd(k: string, ui: boolean, v?: any) {\r\n        if (!this.isSupport(k)) {\r\n            if ('insertHTML' === k) { return this.insertHTML(v); }\r\n            this.toast('ç³»ç»ä¸æ¯æè¯¥å½ä»¤~');\r\n            return false;\r\n        }\r\n        const r = document.execCommand(k, ui, v || '');\r\n        // æ§è¡å®ä»¥ä¸å½ä»¤åï¼éä»£ç åºåéè¦èªå¨æ£æµæå­æ ¼å¼ï¼æ ·å¼ï¼\r\n        const blackList = 'redo,undo,delete,insertHTML,insertHorizontalRule,insertUnorderedList,insertOrderedList';\r\n        if (r && blackList.indexOf(k) > -1 && !this.isRangeInCode()) {\r\n            this.autoActive();\r\n        }\r\n        return r;\r\n    }\r\n\r\n    /**\r\n     * input,click,selectionchangeäºä»¶è®°å½ç¼è¾é¢æ¿åæ ä½ç½®\r\n     */\r\n    private setRange() {\r\n        if (this.isRangeInCode()) {\r\n            this.inCode = true;\r\n        } else {\r\n            this.inCode = false;\r\n        }\r\n        this.range = CursorUtil.getRange(0, this.pannel);\r\n    }\r\n\r\n    /**\r\n     * èªå¨æ£æµæå­æ ¼å¼æ¿æ´»æ ·å¼ï¼å ç²ï¼æä½ï¼ä¸åçº¿ï¼å é¤çº¿ï¼ä¸æ ï¼ä¸æ ......ï¼\r\n     */\r\n    private autoActive() {\r\n        // tslint:disable-next-line: no-angle-bracket-type-assertion\r\n        let p = <HTMLElement>(CursorUtil.getRangeCommonParent());\r\n        if (!p) { return; }\r\n        // å¦æéåå¯¹è±¡çèç¹æ¯ææ¬èç¹ï¼åå°påä¸ºå¶ç¶èç¹\r\n        // tslint:disable-next-line: no-angle-bracket-type-assertion\r\n        if (p.nodeName === '#text') { p = <HTMLElement>p.parentNode; }\r\n        if (!p) {return; }\r\n        // æ®µè½æ ¼å¼\r\n        this.grandChildTograndParent(p, (e: HTMLElement) => {\r\n            if (e === this.pannel) {\r\n                this.cmd('formatBlock', false, 'p');\r\n                this.formatBlock = AppZeditorComponent.FORMAT.formatBlock;\r\n                return true;\r\n            }\r\n            const formatBlock = e.nodeName;\r\n            const formatBlock$ = this.formatBlocks.find((fb: any) => {\r\n                return fb.key.toUpperCase() === formatBlock;\r\n            });\r\n            if (formatBlock$) {\r\n                this.formatBlock = formatBlock$.key;\r\n                return true;\r\n            }\r\n        });\r\n        // å­æ ·\r\n        this.grandChildTograndParent(p, (e: HTMLElement) => {\r\n            if (e === this.pannel) {\r\n                this.fontFamily = AppZeditorComponent.FORMAT.fontFamily;\r\n                return true;\r\n            }\r\n            const fontFamily = e.getAttribute('face');\r\n            if (!fontFamily) { return; }\r\n            const fontFamily$ = this.fontFamilys.find((ff: any) => {\r\n                return ff.value.toLowerCase() === fontFamily.toLowerCase();\r\n            });\r\n            if (fontFamily$) {\r\n                this.fontFamily = fontFamily$;\r\n                return true;\r\n            }\r\n        });\r\n        // å­å·\r\n        this.grandChildTograndParent(p, (e: HTMLElement) => {\r\n            if (e === this.pannel) {\r\n                this.fontSize = AppZeditorComponent.FORMAT.fontSize;\r\n                return true;\r\n            }\r\n            const fontSize = e.getAttribute('size');\r\n            if (!fontSize) { return; }\r\n            const fontSize$ = this.fontSizes.find((fs: any) => {\r\n                return fs.value === fontSize;\r\n            });\r\n            if (fontSize$) {\r\n                this.fontSize = fontSize$;\r\n                return true;\r\n            }\r\n        });\r\n        // åæ¯è²\r\n        this.grandChildTograndParent(p, (e: HTMLElement) => {\r\n            if (e === this.pannel) {\r\n                this.foreColor = AppZeditorComponent.FORMAT.foreColor;\r\n                return true;\r\n            }\r\n            const foreColor = CommonUtil.rgbToHex(e.getAttribute('color'));\r\n            const foreColor$ = CommonUtil.flat(this.colors).find((cr: any) => {\r\n                return cr.toLowerCase() === foreColor.toLowerCase();\r\n            });\r\n            if (foreColor$) {\r\n                this.foreColor = foreColor$;\r\n                return true;\r\n            }\r\n        });\r\n        // èæ¯è²\r\n        this.grandChildTograndParent(p, (e: HTMLElement) => {\r\n            if (e === this.pannel) {\r\n                this.backColor = AppZeditorComponent.FORMAT.backColor;\r\n                return true;\r\n            }\r\n            const backColor = CommonUtil.rgbToHex(e.style.backgroundColor);\r\n            const backColor$ = CommonUtil.flat(this.colors).find((cr: any) => {\r\n                return cr.toLowerCase() === backColor.toLowerCase();\r\n            });\r\n            if (backColor$) {\r\n                this.backColor = backColor$;\r\n                return true;\r\n            }\r\n        });\r\n        // å ç²\r\n        this.grandChildTograndParent(p, (e: HTMLElement) => {\r\n            if (e === this.pannel) {\r\n                this.isBold = AppZeditorComponent.FORMAT.isBold;\r\n                return true;\r\n            }\r\n            if (e.nodeName === 'STRONG' || e.nodeName === 'B') {\r\n                return this.isBold = true;\r\n            }\r\n        });\r\n        // æä½\r\n        this.grandChildTograndParent(p, (e: HTMLElement) => {\r\n            if (e === this.pannel) {\r\n                this.isItalic = AppZeditorComponent.FORMAT.isItalic;\r\n                return true;\r\n            }\r\n            if (e.nodeName === 'EM' || e.nodeName === 'I') {\r\n                return this.isItalic = true;\r\n            }\r\n        });\r\n        // ä¸åçº¿\r\n        this.grandChildTograndParent(p, (e: HTMLElement) => {\r\n            if (e === this.pannel) {\r\n                this.isUnderline = AppZeditorComponent.FORMAT.isUnderline;\r\n                return true;\r\n            }\r\n            if (e.nodeName === 'U') {\r\n                return this.isUnderline = true;\r\n            }\r\n        });\r\n        // å é¤çº¿\r\n        this.grandChildTograndParent(p, (e: HTMLElement) => {\r\n            if (e === this.pannel) {\r\n                this.isStrikeThrough = AppZeditorComponent.FORMAT.isStrikeThrough;\r\n                return true;\r\n            }\r\n            if (e.nodeName === 'STRIKE') {\r\n                return this.isStrikeThrough = true;\r\n            }\r\n        });\r\n        // ä¸æ ï¼ä¸æ \r\n        this.grandChildTograndParent(p, (e: HTMLElement) => {\r\n            if (e === this.pannel) {\r\n                this.scriptActive = AppZeditorComponent.FORMAT.scriptActive;\r\n                return true;\r\n            }\r\n            if (e.nodeName === 'SUP') {\r\n                return this.scriptActive = 'superscript';\r\n            }\r\n            if (e.nodeName === 'SUB') {\r\n                return this.scriptActive = 'subscript';\r\n            }\r\n        });\r\n        // å¯¹é½æ¹å¼\r\n        this.grandChildTograndParent(p, (e: HTMLElement) => {\r\n            if (e === this.pannel) {\r\n                this.justifyActive = AppZeditorComponent.FORMAT.justifyActive;\r\n                return true;\r\n            }\r\n            const textAlign = e.getAttribute('align') || e.style.textAlign;\r\n            if (textAlign === 'left') {\r\n                return this.justifyActive = 'justifyLeft';\r\n            } else if (textAlign === 'center') {\r\n                return this.justifyActive = 'justifyCenter';\r\n            } else if (textAlign === 'right') {\r\n                return this.justifyActive = 'justifyRight';\r\n            } else if (textAlign === 'justify') {\r\n                return this.justifyActive = 'justifyFull';\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * ä»ææ·±å±èç¹å°æå¤å±èç¹æ§è¡åè°\r\n     * @param start ææ·±å±èç¹\r\n     * @param end æå¤å±èç¹\r\n     * @param fn åè° ç´å°åè°è¿åtrueæ¶æä¼ç»æ­¢åè°çæ§è¡\r\n     */\r\n    private grandChildTograndParent(start: any, fn: any) {\r\n        let o = start;\r\n        while (!!o) {\r\n            if (fn(o)) { return; }\r\n            o = o.parentNode;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * æ¾ç®æ åç´ ççæä¸ªæ ç­¾çurlsåbase64çurl\r\n     * @param target åç´ \r\n     * @param tag æ ç­¾\r\n     */\r\n    private getUrlsByTag(target: HTMLElement, tag: string): { type: 'url' | 'base64', src: string }[] {\r\n        const arr = [] as any;\r\n        const tags = target.getElementsByTagName(tag.toUpperCase());\r\n        Array.prototype.forEach.call(tags, elem => {\r\n            const item = {} as any;\r\n            const src = elem.src;\r\n            if (src.indexOf('data:image/png;base64,') === -1) {\r\n                item.type = 'url';\r\n            } else {\r\n                item.type = 'base64';\r\n            }\r\n            item.src = src;\r\n            arr.push(item);\r\n        });\r\n        return arr;\r\n    }\r\n\r\n    /**\r\n     * å¤æ­èå´Rangeæ¯å¦åä»£ç åºæäº¤é\r\n     * @returns true - æäº¤éï¼false - æ äº¤é\r\n     */\r\n    private isRangeInCode(): boolean {\r\n        this.pannelFocus();\r\n        let parent = CursorUtil.getRangeCommonParent() as any;\r\n        if (!parent) { return false; }\r\n        // å¦ææ¯ææ¬èç¹åæ¾å¶ç¶åç´ \r\n        if (parent.nodeType === 3) { parent = parent.parentNode; }\r\n        return (() => { // è¢«åå«\r\n            let parent$ = parent;\r\n            // tslint:disable-next-line: no-conditional-assignment\r\n            while (parent$ = parent$.parentNode) {\r\n                if (parent$.tagName === 'CODE') {\r\n                    return true;\r\n                }\r\n                if (parent$ === this.pannel) {\r\n                    return false;\r\n                }\r\n            }\r\n            return false;\r\n        })() || (() => { // åå«\r\n            const nodes = parent.querySelectorAll('code');\r\n            return nodes && nodes.length;\r\n        })();\r\n    }\r\n\r\n    /**\r\n     * toastæç¤º\r\n     * @param  text? toastæç¤º é»è®¤ä¸ºâè®¾ç½®æ æ~â\r\n     * @param  duration? åçæ¶é´\r\n     */\r\n    private toast(text: string = 'è®¾ç½®æ æ~', obj?: { duration: number, enter: number, leave: number }) {\r\n        return this.domService.tost({ text, ...obj });\r\n    }\r\n\r\n    /**\r\n     * å¼¹çª\r\n     */\r\n    private alert(obj: WindowOptions) {\r\n        return this.domService.alert(obj);\r\n    }\r\n\r\n\r\n    /**\r\n     * é²æ\r\n     * @param  f åè°\r\n     * @param  t? é²ææ¶å»¶ é»è®¤300ms\r\n     */\r\n    private debounce(f: () => void, t: number = 300) {\r\n        const o = this.debounce as any;\r\n        clearTimeout(o.timer);\r\n        o.timer = setTimeout(() => {\r\n            f();\r\n        }, t);\r\n    }\r\n}\r\n","import { NgModule } from '@angular/core';\nimport { SafeHtmlPipe } from './util/safeHtml.pipe';\nimport { DomService } from './service/DomService';\nimport { TipComponent } from './_alert/tip/tip';\nimport { WindowComponent } from './_alert/window/window';\nimport { UILinkComponent } from './ui-link/ui-link';\nimport { UITableComponent } from './ui-table/ui-table';\nimport { UIAnnexComponent } from './ui-annex/ui-annex';\nimport { CheckBoxComponent } from './_form/checkbox/checkbox';\nimport { RadioGroupComponent } from './_form/radio-group/radio-group';\nimport { AppZeditorComponent } from './ng-zeditor.component';\nimport { FormsModule} from '@angular/forms';\nimport { CommonModule } from '@angular/common';\n\n@NgModule({\n    imports: [\n        CommonModule,\n        FormsModule\n    ],\n    declarations: [\n        AppZeditorComponent,\n        TipComponent,\n        WindowComponent,\n        UILinkComponent,\n        UITableComponent,\n        UIAnnexComponent,\n        CheckBoxComponent,\n        RadioGroupComponent,\n        SafeHtmlPipe\n    ],\n    providers: [\n        DomService\n    ],\n    entryComponents: [\n        TipComponent,\n        WindowComponent,\n        UILinkComponent,\n        UITableComponent,\n        UIAnnexComponent\n    ],\n    exports: [\n        AppZeditorComponent,\n        FormsModule,\n        CommonModule\n    ]\n})\nexport class NgZeditorModule { }\n"]}